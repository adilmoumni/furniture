{"ast":null,"code":"function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nimport algoliasearchHelper from 'algoliasearch-helper';\nimport EventEmitter from 'events';\nimport index, { isIndexWidget } from '../widgets/index/index';\nimport version from './version';\nimport createHelpers from './createHelpers';\nimport { createDocumentationMessageGenerator, createDocumentationLink, defer, noop, warning, checkIndexUiState } from './utils';\nimport { createRouterMiddleware } from '../middlewares/createRouterMiddleware';\nimport { createMetadataMiddleware, isMetadataEnabled } from '../middlewares/createMetadataMiddleware';\nvar withUsage = createDocumentationMessageGenerator({\n  name: 'instantsearch'\n});\n\nfunction defaultCreateURL() {\n  return '#';\n}\n/**\n * Global options for an InstantSearch instance.\n */\n\n/**\n * The actual implementation of the InstantSearch. This is\n * created using the `instantsearch` factory function.\n * It emits the 'render' event every time a search is done\n */\n\n\nvar InstantSearch = /*#__PURE__*/function (_EventEmitter) {\n  _inherits(InstantSearch, _EventEmitter);\n\n  var _super = _createSuper(InstantSearch);\n\n  function InstantSearch(options) {\n    var _this;\n\n    _classCallCheck(this, InstantSearch);\n\n    _this = _super.call(this);\n\n    _defineProperty(_assertThisInitialized(_this), \"client\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"indexName\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"insightsClient\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"onStateChange\", null);\n\n    _defineProperty(_assertThisInitialized(_this), \"helper\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"mainHelper\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"mainIndex\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"started\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"templatesConfig\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"renderState\", {});\n\n    _defineProperty(_assertThisInitialized(_this), \"_stalledSearchDelay\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"_searchStalledTimer\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"_isSearchStalled\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"_initialUiState\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"_createURL\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"_searchFunction\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"_mainHelperSearch\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"middleware\", []);\n\n    _defineProperty(_assertThisInitialized(_this), \"sendEventToInsights\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"scheduleSearch\", defer(function () {\n      if (_this.started) {\n        _this.mainHelper.search();\n      }\n    }));\n\n    _defineProperty(_assertThisInitialized(_this), \"scheduleRender\", defer(function () {\n      if (!_this.mainHelper.hasPendingRequests()) {\n        clearTimeout(_this._searchStalledTimer);\n        _this._searchStalledTimer = null;\n        _this._isSearchStalled = false;\n      }\n\n      _this.mainIndex.render({\n        instantSearchInstance: _assertThisInitialized(_this)\n      });\n\n      _this.emit('render');\n    }));\n\n    _defineProperty(_assertThisInitialized(_this), \"onInternalStateChange\", defer(function () {\n      var nextUiState = _this.mainIndex.getWidgetUiState({});\n\n      _this.middleware.forEach(function (_ref) {\n        var instance = _ref.instance;\n        instance.onStateChange({\n          uiState: nextUiState\n        });\n      });\n    }));\n\n    var _options$indexName = options.indexName,\n        indexName = _options$indexName === void 0 ? null : _options$indexName,\n        numberLocale = options.numberLocale,\n        _options$initialUiSta = options.initialUiState,\n        initialUiState = _options$initialUiSta === void 0 ? {} : _options$initialUiSta,\n        _options$routing = options.routing,\n        routing = _options$routing === void 0 ? null : _options$routing,\n        searchFunction = options.searchFunction,\n        _options$stalledSearc = options.stalledSearchDelay,\n        stalledSearchDelay = _options$stalledSearc === void 0 ? 200 : _options$stalledSearc,\n        _options$searchClient = options.searchClient,\n        searchClient = _options$searchClient === void 0 ? null : _options$searchClient,\n        _options$insightsClie = options.insightsClient,\n        insightsClient = _options$insightsClie === void 0 ? null : _options$insightsClie,\n        _options$onStateChang = options.onStateChange,\n        onStateChange = _options$onStateChang === void 0 ? null : _options$onStateChang;\n\n    if (indexName === null) {\n      throw new Error(withUsage('The `indexName` option is required.'));\n    }\n\n    if (searchClient === null) {\n      throw new Error(withUsage('The `searchClient` option is required.'));\n    }\n\n    if (typeof searchClient.search !== 'function') {\n      throw new Error(\"The `searchClient` must implement a `search` method.\\n\\nSee: https://www.algolia.com/doc/guides/building-search-ui/going-further/backend-search/in-depth/backend-instantsearch/js/\");\n    }\n\n    if (typeof searchClient.addAlgoliaAgent === 'function') {\n      searchClient.addAlgoliaAgent(\"instantsearch.js (\".concat(version, \")\"));\n    }\n\n    process.env.NODE_ENV === 'development' ? warning(insightsClient === null, \"`insightsClient` property has been deprecated. It is still supported in 4.x releases, but not further. It is replaced by the `insights` middleware.\\n\\nFor more information, visit https://www.algolia.com/doc/guides/getting-insights-and-analytics/search-analytics/click-through-and-conversions/how-to/send-click-and-conversion-events-with-instantsearch/js/\") : void 0;\n\n    if (insightsClient && typeof insightsClient !== 'function') {\n      throw new Error(withUsage('The `insightsClient` option should be a function.'));\n    }\n\n    process.env.NODE_ENV === 'development' ? warning(!options.searchParameters, \"The `searchParameters` option is deprecated and will not be supported in InstantSearch.js 4.x.\\n\\nYou can replace it with the `configure` widget:\\n\\n```\\nsearch.addWidgets([\\n  configure(\".concat(JSON.stringify(options.searchParameters, null, 2), \")\\n]);\\n```\\n\\nSee \").concat(createDocumentationLink({\n      name: 'configure'\n    }))) : void 0;\n    _this.client = searchClient;\n    _this.insightsClient = insightsClient;\n    _this.indexName = indexName;\n    _this.helper = null;\n    _this.mainHelper = null;\n    _this.mainIndex = index({\n      indexName: indexName\n    });\n    _this.onStateChange = onStateChange;\n    _this.started = false;\n    _this.templatesConfig = {\n      helpers: createHelpers({\n        numberLocale: numberLocale\n      }),\n      compileOptions: {}\n    };\n    _this._stalledSearchDelay = stalledSearchDelay;\n    _this._searchStalledTimer = null;\n    _this._isSearchStalled = false;\n    _this._createURL = defaultCreateURL;\n    _this._initialUiState = initialUiState;\n\n    if (searchFunction) {\n      _this._searchFunction = searchFunction;\n    }\n\n    _this.sendEventToInsights = noop;\n\n    if (routing) {\n      var routerOptions = typeof routing === 'boolean' ? undefined : routing;\n\n      _this.use(createRouterMiddleware(routerOptions));\n    }\n\n    if (isMetadataEnabled()) {\n      _this.use(createMetadataMiddleware());\n    }\n\n    return _this;\n  }\n  /**\n   * Hooks a middleware into the InstantSearch lifecycle.\n   */\n\n\n  _createClass(InstantSearch, [{\n    key: \"use\",\n    value: function use() {\n      var _this2 = this;\n\n      for (var _len = arguments.length, middleware = new Array(_len), _key = 0; _key < _len; _key++) {\n        middleware[_key] = arguments[_key];\n      }\n\n      var newMiddlewareList = middleware.map(function (fn) {\n        var newMiddleware = _objectSpread({\n          subscribe: noop,\n          unsubscribe: noop,\n          onStateChange: noop\n        }, fn({\n          instantSearchInstance: _this2\n        }));\n\n        _this2.middleware.push({\n          creator: fn,\n          instance: newMiddleware\n        });\n\n        return newMiddleware;\n      }); // If the instance has already started, we directly subscribe the\n      // middleware so they're notified of changes.\n\n      if (this.started) {\n        newMiddlewareList.forEach(function (m) {\n          m.subscribe();\n        });\n      }\n\n      return this;\n    }\n    /**\n     * Removes a middleware from the InstantSearch lifecycle.\n     */\n\n  }, {\n    key: \"unuse\",\n    value: function unuse() {\n      for (var _len2 = arguments.length, middlewareToUnuse = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        middlewareToUnuse[_key2] = arguments[_key2];\n      }\n\n      this.middleware.filter(function (m) {\n        return middlewareToUnuse.includes(m.creator);\n      }).forEach(function (m) {\n        return m.instance.unsubscribe();\n      });\n      this.middleware = this.middleware.filter(function (m) {\n        return !middlewareToUnuse.includes(m.creator);\n      });\n      return this;\n    } // @major we shipped with EXPERIMENTAL_use, but have changed that to just `use` now\n\n  }, {\n    key: \"EXPERIMENTAL_use\",\n    value: function EXPERIMENTAL_use() {\n      process.env.NODE_ENV === 'development' ? warning(false, 'The middleware API is now considered stable, so we recommend replacing `EXPERIMENTAL_use` with `use` before upgrading to the next major version.') : void 0;\n      return this.use.apply(this, arguments);\n    }\n    /**\n     * Adds a widget to the search instance.\n     * A widget can be added either before or after InstantSearch has started.\n     * @param widget The widget to add to InstantSearch.\n     *\n     * @deprecated This method will still be supported in 4.x releases, but not further. It is replaced by `addWidgets([widget])`.\n     */\n\n  }, {\n    key: \"addWidget\",\n    value: function addWidget(widget) {\n      process.env.NODE_ENV === 'development' ? warning(false, 'addWidget will still be supported in 4.x releases, but not further. It is replaced by `addWidgets([widget])`') : void 0;\n      return this.addWidgets([widget]);\n    }\n    /**\n     * Adds multiple widgets to the search instance.\n     * Widgets can be added either before or after InstantSearch has started.\n     * @param widgets The array of widgets to add to InstantSearch.\n     */\n\n  }, {\n    key: \"addWidgets\",\n    value: function addWidgets(widgets) {\n      if (!Array.isArray(widgets)) {\n        throw new Error(withUsage('The `addWidgets` method expects an array of widgets. Please use `addWidget`.'));\n      }\n\n      if (widgets.some(function (widget) {\n        return typeof widget.init !== 'function' && typeof widget.render !== 'function';\n      })) {\n        throw new Error(withUsage('The widget definition expects a `render` and/or an `init` method.'));\n      }\n\n      this.mainIndex.addWidgets(widgets);\n      return this;\n    }\n    /**\n     * Removes a widget from the search instance.\n     * @deprecated This method will still be supported in 4.x releases, but not further. It is replaced by `removeWidgets([widget])`\n     * @param widget The widget instance to remove from InstantSearch.\n     *\n     * The widget must implement a `dispose()` method to clear its state.\n     */\n\n  }, {\n    key: \"removeWidget\",\n    value: function removeWidget(widget) {\n      process.env.NODE_ENV === 'development' ? warning(false, 'removeWidget will still be supported in 4.x releases, but not further. It is replaced by `removeWidgets([widget])`') : void 0;\n      return this.removeWidgets([widget]);\n    }\n    /**\n     * Removes multiple widgets from the search instance.\n     * @param widgets Array of widgets instances to remove from InstantSearch.\n     *\n     * The widgets must implement a `dispose()` method to clear their states.\n     */\n\n  }, {\n    key: \"removeWidgets\",\n    value: function removeWidgets(widgets) {\n      if (!Array.isArray(widgets)) {\n        throw new Error(withUsage('The `removeWidgets` method expects an array of widgets. Please use `removeWidget`.'));\n      }\n\n      if (widgets.some(function (widget) {\n        return typeof widget.dispose !== 'function';\n      })) {\n        throw new Error(withUsage('The widget definition expects a `dispose` method.'));\n      }\n\n      this.mainIndex.removeWidgets(widgets);\n      return this;\n    }\n    /**\n     * Ends the initialization of InstantSearch.js and triggers the\n     * first search. This method should be called after all widgets have been added\n     * to the instance of InstantSearch.js. InstantSearch.js also supports adding and removing\n     * widgets after the start as an **EXPERIMENTAL** feature.\n     */\n\n  }, {\n    key: \"start\",\n    value: function start() {\n      var _this3 = this;\n\n      if (this.started) {\n        throw new Error(withUsage('The `start` method has already been called once.'));\n      } // This Helper is used for the queries, we don't care about its state. The\n      // states are managed at the `index` level. We use this Helper to create\n      // DerivedHelper scoped into the `index` widgets.\n      // In Vue InstantSearch' hydrate, a main helper gets set before start, so\n      // we need to respect this helper as a way to keep all listeners correct.\n\n\n      var mainHelper = this.mainHelper || algoliasearchHelper(this.client, this.indexName);\n\n      mainHelper.search = function () {\n        // This solution allows us to keep the exact same API for the users but\n        // under the hood, we have a different implementation. It should be\n        // completely transparent for the rest of the codebase. Only this module\n        // is impacted.\n        return mainHelper.searchOnlyWithDerivedHelpers();\n      };\n\n      if (this._searchFunction) {\n        // this client isn't used to actually search, but required for the helper\n        // to not throw errors\n        var fakeClient = {\n          search: function search() {\n            return new Promise(noop);\n          }\n        };\n        this._mainHelperSearch = mainHelper.search.bind(mainHelper);\n\n        mainHelper.search = function () {\n          var mainIndexHelper = _this3.mainIndex.getHelper();\n\n          var searchFunctionHelper = algoliasearchHelper(fakeClient, mainIndexHelper.state.index, mainIndexHelper.state);\n          searchFunctionHelper.once('search', function (_ref2) {\n            var state = _ref2.state;\n            mainIndexHelper.overrideStateWithoutTriggeringChangeEvent(state);\n\n            _this3._mainHelperSearch();\n          }); // Forward state changes from `searchFunctionHelper` to `mainIndexHelper`\n\n          searchFunctionHelper.on('change', function (_ref3) {\n            var state = _ref3.state;\n            mainIndexHelper.setState(state);\n          });\n\n          _this3._searchFunction(searchFunctionHelper);\n\n          return mainHelper;\n        };\n      } // Only the \"main\" Helper emits the `error` event vs the one for `search`\n      // and `results` that are also emitted on the derived one.\n\n\n      mainHelper.on('error', function (_ref4) {\n        var error = _ref4.error;\n\n        _this3.emit('error', {\n          error: error\n        });\n      });\n      this.mainHelper = mainHelper;\n      this.middleware.forEach(function (_ref5) {\n        var instance = _ref5.instance;\n        instance.subscribe();\n      });\n      this.mainIndex.init({\n        instantSearchInstance: this,\n        parent: null,\n        uiState: this._initialUiState\n      });\n      mainHelper.search(); // Keep the previous reference for legacy purpose, some pattern use\n      // the direct Helper access `search.helper` (e.g multi-index).\n\n      this.helper = this.mainIndex.getHelper(); // track we started the search if we add more widgets,\n      // to init them directly after add\n\n      this.started = true;\n    }\n    /**\n     * Removes all widgets without triggering a search afterwards. This is an **EXPERIMENTAL** feature,\n     * if you find an issue with it, please\n     * [open an issue](https://github.com/algolia/instantsearch.js/issues/new?title=Problem%20with%20dispose).\n     * @return {undefined} This method does not return anything\n     */\n\n  }, {\n    key: \"dispose\",\n    value: function dispose() {\n      this.scheduleSearch.cancel();\n      this.scheduleRender.cancel();\n      clearTimeout(this._searchStalledTimer);\n      this.removeWidgets(this.mainIndex.getWidgets());\n      this.mainIndex.dispose(); // You can not start an instance two times, therefore a disposed instance\n      // needs to set started as false otherwise this can not be restarted at a\n      // later point.\n\n      this.started = false; // The helper needs to be reset to perform the next search from a fresh state.\n      // If not reset, it would use the state stored before calling `dispose()`.\n\n      this.removeAllListeners();\n      this.mainHelper.removeAllListeners();\n      this.mainHelper = null;\n      this.helper = null;\n      this.middleware.forEach(function (_ref6) {\n        var instance = _ref6.instance;\n        instance.unsubscribe();\n      });\n    }\n  }, {\n    key: \"scheduleStalledRender\",\n    value: function scheduleStalledRender() {\n      var _this4 = this;\n\n      if (!this._searchStalledTimer) {\n        this._searchStalledTimer = setTimeout(function () {\n          _this4._isSearchStalled = true;\n\n          _this4.scheduleRender();\n        }, this._stalledSearchDelay);\n      }\n    }\n  }, {\n    key: \"setUiState\",\n    value: function setUiState(uiState) {\n      if (!this.mainHelper) {\n        throw new Error(withUsage('The `start` method needs to be called before `setUiState`.'));\n      } // We refresh the index UI state to update the local UI state that the\n      // main index passes to the function form of `setUiState`.\n\n\n      this.mainIndex.refreshUiState();\n      var nextUiState = typeof uiState === 'function' ? uiState(this.mainIndex.getWidgetUiState({})) : uiState;\n\n      var setIndexHelperState = function setIndexHelperState(indexWidget) {\n        if (process.env.NODE_ENV === 'development') {\n          checkIndexUiState({\n            index: indexWidget,\n            indexUiState: nextUiState[indexWidget.getIndexId()]\n          });\n        }\n\n        indexWidget.getHelper().setState(indexWidget.getWidgetSearchParameters(indexWidget.getHelper().state, {\n          uiState: nextUiState[indexWidget.getIndexId()]\n        }));\n        indexWidget.getWidgets().filter(isIndexWidget).forEach(setIndexHelperState);\n      };\n\n      setIndexHelperState(this.mainIndex);\n      this.scheduleSearch();\n      this.onInternalStateChange();\n    }\n  }, {\n    key: \"getUiState\",\n    value: function getUiState() {\n      if (this.started) {\n        // We refresh the index UI state to make sure changes from `refine` are taken in account\n        this.mainIndex.refreshUiState();\n      }\n\n      return this.mainIndex.getWidgetUiState({});\n    }\n  }, {\n    key: \"createURL\",\n    value: function createURL() {\n      var nextState = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n      if (!this.started) {\n        throw new Error(withUsage('The `start` method needs to be called before `createURL`.'));\n      }\n\n      return this._createURL(nextState);\n    }\n  }, {\n    key: \"refresh\",\n    value: function refresh() {\n      if (!this.mainHelper) {\n        throw new Error(withUsage('The `start` method needs to be called before `refresh`.'));\n      }\n\n      this.mainHelper.clearCache().search();\n    }\n  }]);\n\n  return InstantSearch;\n}(EventEmitter);\n\nexport default InstantSearch;","map":{"version":3,"sources":["/Users/adil/Documents/GitHub/furniture-front/node_modules/instantsearch.js/es/lib/InstantSearch.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","_classCallCheck","instance","Constructor","TypeError","_defineProperties","props","descriptor","configurable","writable","_createClass","protoProps","staticProps","_inherits","subClass","superClass","create","value","_setPrototypeOf","o","p","setPrototypeOf","__proto__","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","_getPrototypeOf","result","NewTarget","Reflect","construct","_possibleConstructorReturn","self","call","_assertThisInitialized","ReferenceError","sham","Proxy","Date","toString","e","getPrototypeOf","algoliasearchHelper","EventEmitter","index","isIndexWidget","version","createHelpers","createDocumentationMessageGenerator","createDocumentationLink","defer","noop","warning","checkIndexUiState","createRouterMiddleware","createMetadataMiddleware","isMetadataEnabled","withUsage","name","defaultCreateURL","InstantSearch","_EventEmitter","_super","options","_this","started","mainHelper","search","hasPendingRequests","clearTimeout","_searchStalledTimer","_isSearchStalled","mainIndex","render","instantSearchInstance","emit","nextUiState","getWidgetUiState","middleware","_ref","onStateChange","uiState","_options$indexName","indexName","numberLocale","_options$initialUiSta","initialUiState","_options$routing","routing","searchFunction","_options$stalledSearc","stalledSearchDelay","_options$searchClient","searchClient","_options$insightsClie","insightsClient","_options$onStateChang","Error","addAlgoliaAgent","concat","process","env","NODE_ENV","searchParameters","JSON","stringify","client","helper","templatesConfig","helpers","compileOptions","_stalledSearchDelay","_createURL","_initialUiState","_searchFunction","sendEventToInsights","routerOptions","undefined","use","_this2","_len","Array","_key","newMiddlewareList","map","fn","newMiddleware","subscribe","unsubscribe","creator","m","unuse","_len2","middlewareToUnuse","_key2","includes","EXPERIMENTAL_use","addWidget","widget","addWidgets","widgets","isArray","some","init","removeWidget","removeWidgets","dispose","start","_this3","searchOnlyWithDerivedHelpers","fakeClient","Promise","_mainHelperSearch","bind","mainIndexHelper","getHelper","searchFunctionHelper","state","once","_ref2","overrideStateWithoutTriggeringChangeEvent","on","_ref3","setState","_ref4","error","_ref5","parent","scheduleSearch","cancel","scheduleRender","getWidgets","removeAllListeners","_ref6","scheduleStalledRender","_this4","setTimeout","setUiState","refreshUiState","setIndexHelperState","indexWidget","indexUiState","getIndexId","getWidgetSearchParameters","onInternalStateChange","getUiState","createURL","nextState","refresh","clearCache"],"mappings":"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","sourcesContent":["function _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport algoliasearchHelper from 'algoliasearch-helper';\nimport EventEmitter from 'events';\nimport index, { isIndexWidget } from '../widgets/index/index';\nimport version from './version';\nimport createHelpers from './createHelpers';\nimport { createDocumentationMessageGenerator, createDocumentationLink, defer, noop, warning, checkIndexUiState } from './utils';\nimport { createRouterMiddleware } from '../middlewares/createRouterMiddleware';\nimport { createMetadataMiddleware, isMetadataEnabled } from '../middlewares/createMetadataMiddleware';\nvar withUsage = createDocumentationMessageGenerator({\n  name: 'instantsearch'\n});\n\nfunction defaultCreateURL() {\n  return '#';\n}\n/**\n * Global options for an InstantSearch instance.\n */\n\n\n/**\n * The actual implementation of the InstantSearch. This is\n * created using the `instantsearch` factory function.\n * It emits the 'render' event every time a search is done\n */\nvar InstantSearch = /*#__PURE__*/function (_EventEmitter) {\n  _inherits(InstantSearch, _EventEmitter);\n\n  var _super = _createSuper(InstantSearch);\n\n  function InstantSearch(options) {\n    var _this;\n\n    _classCallCheck(this, InstantSearch);\n\n    _this = _super.call(this);\n\n    _defineProperty(_assertThisInitialized(_this), \"client\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"indexName\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"insightsClient\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"onStateChange\", null);\n\n    _defineProperty(_assertThisInitialized(_this), \"helper\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"mainHelper\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"mainIndex\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"started\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"templatesConfig\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"renderState\", {});\n\n    _defineProperty(_assertThisInitialized(_this), \"_stalledSearchDelay\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"_searchStalledTimer\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"_isSearchStalled\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"_initialUiState\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"_createURL\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"_searchFunction\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"_mainHelperSearch\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"middleware\", []);\n\n    _defineProperty(_assertThisInitialized(_this), \"sendEventToInsights\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"scheduleSearch\", defer(function () {\n      if (_this.started) {\n        _this.mainHelper.search();\n      }\n    }));\n\n    _defineProperty(_assertThisInitialized(_this), \"scheduleRender\", defer(function () {\n      if (!_this.mainHelper.hasPendingRequests()) {\n        clearTimeout(_this._searchStalledTimer);\n        _this._searchStalledTimer = null;\n        _this._isSearchStalled = false;\n      }\n\n      _this.mainIndex.render({\n        instantSearchInstance: _assertThisInitialized(_this)\n      });\n\n      _this.emit('render');\n    }));\n\n    _defineProperty(_assertThisInitialized(_this), \"onInternalStateChange\", defer(function () {\n      var nextUiState = _this.mainIndex.getWidgetUiState({});\n\n      _this.middleware.forEach(function (_ref) {\n        var instance = _ref.instance;\n        instance.onStateChange({\n          uiState: nextUiState\n        });\n      });\n    }));\n\n    var _options$indexName = options.indexName,\n        indexName = _options$indexName === void 0 ? null : _options$indexName,\n        numberLocale = options.numberLocale,\n        _options$initialUiSta = options.initialUiState,\n        initialUiState = _options$initialUiSta === void 0 ? {} : _options$initialUiSta,\n        _options$routing = options.routing,\n        routing = _options$routing === void 0 ? null : _options$routing,\n        searchFunction = options.searchFunction,\n        _options$stalledSearc = options.stalledSearchDelay,\n        stalledSearchDelay = _options$stalledSearc === void 0 ? 200 : _options$stalledSearc,\n        _options$searchClient = options.searchClient,\n        searchClient = _options$searchClient === void 0 ? null : _options$searchClient,\n        _options$insightsClie = options.insightsClient,\n        insightsClient = _options$insightsClie === void 0 ? null : _options$insightsClie,\n        _options$onStateChang = options.onStateChange,\n        onStateChange = _options$onStateChang === void 0 ? null : _options$onStateChang;\n\n    if (indexName === null) {\n      throw new Error(withUsage('The `indexName` option is required.'));\n    }\n\n    if (searchClient === null) {\n      throw new Error(withUsage('The `searchClient` option is required.'));\n    }\n\n    if (typeof searchClient.search !== 'function') {\n      throw new Error(\"The `searchClient` must implement a `search` method.\\n\\nSee: https://www.algolia.com/doc/guides/building-search-ui/going-further/backend-search/in-depth/backend-instantsearch/js/\");\n    }\n\n    if (typeof searchClient.addAlgoliaAgent === 'function') {\n      searchClient.addAlgoliaAgent(\"instantsearch.js (\".concat(version, \")\"));\n    }\n\n    process.env.NODE_ENV === 'development' ? warning(insightsClient === null, \"`insightsClient` property has been deprecated. It is still supported in 4.x releases, but not further. It is replaced by the `insights` middleware.\\n\\nFor more information, visit https://www.algolia.com/doc/guides/getting-insights-and-analytics/search-analytics/click-through-and-conversions/how-to/send-click-and-conversion-events-with-instantsearch/js/\") : void 0;\n\n    if (insightsClient && typeof insightsClient !== 'function') {\n      throw new Error(withUsage('The `insightsClient` option should be a function.'));\n    }\n\n    process.env.NODE_ENV === 'development' ? warning(!options.searchParameters, \"The `searchParameters` option is deprecated and will not be supported in InstantSearch.js 4.x.\\n\\nYou can replace it with the `configure` widget:\\n\\n```\\nsearch.addWidgets([\\n  configure(\".concat(JSON.stringify(options.searchParameters, null, 2), \")\\n]);\\n```\\n\\nSee \").concat(createDocumentationLink({\n      name: 'configure'\n    }))) : void 0;\n    _this.client = searchClient;\n    _this.insightsClient = insightsClient;\n    _this.indexName = indexName;\n    _this.helper = null;\n    _this.mainHelper = null;\n    _this.mainIndex = index({\n      indexName: indexName\n    });\n    _this.onStateChange = onStateChange;\n    _this.started = false;\n    _this.templatesConfig = {\n      helpers: createHelpers({\n        numberLocale: numberLocale\n      }),\n      compileOptions: {}\n    };\n    _this._stalledSearchDelay = stalledSearchDelay;\n    _this._searchStalledTimer = null;\n    _this._isSearchStalled = false;\n    _this._createURL = defaultCreateURL;\n    _this._initialUiState = initialUiState;\n\n    if (searchFunction) {\n      _this._searchFunction = searchFunction;\n    }\n\n    _this.sendEventToInsights = noop;\n\n    if (routing) {\n      var routerOptions = typeof routing === 'boolean' ? undefined : routing;\n\n      _this.use(createRouterMiddleware(routerOptions));\n    }\n\n    if (isMetadataEnabled()) {\n      _this.use(createMetadataMiddleware());\n    }\n\n    return _this;\n  }\n  /**\n   * Hooks a middleware into the InstantSearch lifecycle.\n   */\n\n\n  _createClass(InstantSearch, [{\n    key: \"use\",\n    value: function use() {\n      var _this2 = this;\n\n      for (var _len = arguments.length, middleware = new Array(_len), _key = 0; _key < _len; _key++) {\n        middleware[_key] = arguments[_key];\n      }\n\n      var newMiddlewareList = middleware.map(function (fn) {\n        var newMiddleware = _objectSpread({\n          subscribe: noop,\n          unsubscribe: noop,\n          onStateChange: noop\n        }, fn({\n          instantSearchInstance: _this2\n        }));\n\n        _this2.middleware.push({\n          creator: fn,\n          instance: newMiddleware\n        });\n\n        return newMiddleware;\n      }); // If the instance has already started, we directly subscribe the\n      // middleware so they're notified of changes.\n\n      if (this.started) {\n        newMiddlewareList.forEach(function (m) {\n          m.subscribe();\n        });\n      }\n\n      return this;\n    }\n    /**\n     * Removes a middleware from the InstantSearch lifecycle.\n     */\n\n  }, {\n    key: \"unuse\",\n    value: function unuse() {\n      for (var _len2 = arguments.length, middlewareToUnuse = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        middlewareToUnuse[_key2] = arguments[_key2];\n      }\n\n      this.middleware.filter(function (m) {\n        return middlewareToUnuse.includes(m.creator);\n      }).forEach(function (m) {\n        return m.instance.unsubscribe();\n      });\n      this.middleware = this.middleware.filter(function (m) {\n        return !middlewareToUnuse.includes(m.creator);\n      });\n      return this;\n    } // @major we shipped with EXPERIMENTAL_use, but have changed that to just `use` now\n\n  }, {\n    key: \"EXPERIMENTAL_use\",\n    value: function EXPERIMENTAL_use() {\n      process.env.NODE_ENV === 'development' ? warning(false, 'The middleware API is now considered stable, so we recommend replacing `EXPERIMENTAL_use` with `use` before upgrading to the next major version.') : void 0;\n      return this.use.apply(this, arguments);\n    }\n    /**\n     * Adds a widget to the search instance.\n     * A widget can be added either before or after InstantSearch has started.\n     * @param widget The widget to add to InstantSearch.\n     *\n     * @deprecated This method will still be supported in 4.x releases, but not further. It is replaced by `addWidgets([widget])`.\n     */\n\n  }, {\n    key: \"addWidget\",\n    value: function addWidget(widget) {\n      process.env.NODE_ENV === 'development' ? warning(false, 'addWidget will still be supported in 4.x releases, but not further. It is replaced by `addWidgets([widget])`') : void 0;\n      return this.addWidgets([widget]);\n    }\n    /**\n     * Adds multiple widgets to the search instance.\n     * Widgets can be added either before or after InstantSearch has started.\n     * @param widgets The array of widgets to add to InstantSearch.\n     */\n\n  }, {\n    key: \"addWidgets\",\n    value: function addWidgets(widgets) {\n      if (!Array.isArray(widgets)) {\n        throw new Error(withUsage('The `addWidgets` method expects an array of widgets. Please use `addWidget`.'));\n      }\n\n      if (widgets.some(function (widget) {\n        return typeof widget.init !== 'function' && typeof widget.render !== 'function';\n      })) {\n        throw new Error(withUsage('The widget definition expects a `render` and/or an `init` method.'));\n      }\n\n      this.mainIndex.addWidgets(widgets);\n      return this;\n    }\n    /**\n     * Removes a widget from the search instance.\n     * @deprecated This method will still be supported in 4.x releases, but not further. It is replaced by `removeWidgets([widget])`\n     * @param widget The widget instance to remove from InstantSearch.\n     *\n     * The widget must implement a `dispose()` method to clear its state.\n     */\n\n  }, {\n    key: \"removeWidget\",\n    value: function removeWidget(widget) {\n      process.env.NODE_ENV === 'development' ? warning(false, 'removeWidget will still be supported in 4.x releases, but not further. It is replaced by `removeWidgets([widget])`') : void 0;\n      return this.removeWidgets([widget]);\n    }\n    /**\n     * Removes multiple widgets from the search instance.\n     * @param widgets Array of widgets instances to remove from InstantSearch.\n     *\n     * The widgets must implement a `dispose()` method to clear their states.\n     */\n\n  }, {\n    key: \"removeWidgets\",\n    value: function removeWidgets(widgets) {\n      if (!Array.isArray(widgets)) {\n        throw new Error(withUsage('The `removeWidgets` method expects an array of widgets. Please use `removeWidget`.'));\n      }\n\n      if (widgets.some(function (widget) {\n        return typeof widget.dispose !== 'function';\n      })) {\n        throw new Error(withUsage('The widget definition expects a `dispose` method.'));\n      }\n\n      this.mainIndex.removeWidgets(widgets);\n      return this;\n    }\n    /**\n     * Ends the initialization of InstantSearch.js and triggers the\n     * first search. This method should be called after all widgets have been added\n     * to the instance of InstantSearch.js. InstantSearch.js also supports adding and removing\n     * widgets after the start as an **EXPERIMENTAL** feature.\n     */\n\n  }, {\n    key: \"start\",\n    value: function start() {\n      var _this3 = this;\n\n      if (this.started) {\n        throw new Error(withUsage('The `start` method has already been called once.'));\n      } // This Helper is used for the queries, we don't care about its state. The\n      // states are managed at the `index` level. We use this Helper to create\n      // DerivedHelper scoped into the `index` widgets.\n      // In Vue InstantSearch' hydrate, a main helper gets set before start, so\n      // we need to respect this helper as a way to keep all listeners correct.\n\n\n      var mainHelper = this.mainHelper || algoliasearchHelper(this.client, this.indexName);\n\n      mainHelper.search = function () {\n        // This solution allows us to keep the exact same API for the users but\n        // under the hood, we have a different implementation. It should be\n        // completely transparent for the rest of the codebase. Only this module\n        // is impacted.\n        return mainHelper.searchOnlyWithDerivedHelpers();\n      };\n\n      if (this._searchFunction) {\n        // this client isn't used to actually search, but required for the helper\n        // to not throw errors\n        var fakeClient = {\n          search: function search() {\n            return new Promise(noop);\n          }\n        };\n        this._mainHelperSearch = mainHelper.search.bind(mainHelper);\n\n        mainHelper.search = function () {\n          var mainIndexHelper = _this3.mainIndex.getHelper();\n\n          var searchFunctionHelper = algoliasearchHelper(fakeClient, mainIndexHelper.state.index, mainIndexHelper.state);\n          searchFunctionHelper.once('search', function (_ref2) {\n            var state = _ref2.state;\n            mainIndexHelper.overrideStateWithoutTriggeringChangeEvent(state);\n\n            _this3._mainHelperSearch();\n          }); // Forward state changes from `searchFunctionHelper` to `mainIndexHelper`\n\n          searchFunctionHelper.on('change', function (_ref3) {\n            var state = _ref3.state;\n            mainIndexHelper.setState(state);\n          });\n\n          _this3._searchFunction(searchFunctionHelper);\n\n          return mainHelper;\n        };\n      } // Only the \"main\" Helper emits the `error` event vs the one for `search`\n      // and `results` that are also emitted on the derived one.\n\n\n      mainHelper.on('error', function (_ref4) {\n        var error = _ref4.error;\n\n        _this3.emit('error', {\n          error: error\n        });\n      });\n      this.mainHelper = mainHelper;\n      this.middleware.forEach(function (_ref5) {\n        var instance = _ref5.instance;\n        instance.subscribe();\n      });\n      this.mainIndex.init({\n        instantSearchInstance: this,\n        parent: null,\n        uiState: this._initialUiState\n      });\n      mainHelper.search(); // Keep the previous reference for legacy purpose, some pattern use\n      // the direct Helper access `search.helper` (e.g multi-index).\n\n      this.helper = this.mainIndex.getHelper(); // track we started the search if we add more widgets,\n      // to init them directly after add\n\n      this.started = true;\n    }\n    /**\n     * Removes all widgets without triggering a search afterwards. This is an **EXPERIMENTAL** feature,\n     * if you find an issue with it, please\n     * [open an issue](https://github.com/algolia/instantsearch.js/issues/new?title=Problem%20with%20dispose).\n     * @return {undefined} This method does not return anything\n     */\n\n  }, {\n    key: \"dispose\",\n    value: function dispose() {\n      this.scheduleSearch.cancel();\n      this.scheduleRender.cancel();\n      clearTimeout(this._searchStalledTimer);\n      this.removeWidgets(this.mainIndex.getWidgets());\n      this.mainIndex.dispose(); // You can not start an instance two times, therefore a disposed instance\n      // needs to set started as false otherwise this can not be restarted at a\n      // later point.\n\n      this.started = false; // The helper needs to be reset to perform the next search from a fresh state.\n      // If not reset, it would use the state stored before calling `dispose()`.\n\n      this.removeAllListeners();\n      this.mainHelper.removeAllListeners();\n      this.mainHelper = null;\n      this.helper = null;\n      this.middleware.forEach(function (_ref6) {\n        var instance = _ref6.instance;\n        instance.unsubscribe();\n      });\n    }\n  }, {\n    key: \"scheduleStalledRender\",\n    value: function scheduleStalledRender() {\n      var _this4 = this;\n\n      if (!this._searchStalledTimer) {\n        this._searchStalledTimer = setTimeout(function () {\n          _this4._isSearchStalled = true;\n\n          _this4.scheduleRender();\n        }, this._stalledSearchDelay);\n      }\n    }\n  }, {\n    key: \"setUiState\",\n    value: function setUiState(uiState) {\n      if (!this.mainHelper) {\n        throw new Error(withUsage('The `start` method needs to be called before `setUiState`.'));\n      } // We refresh the index UI state to update the local UI state that the\n      // main index passes to the function form of `setUiState`.\n\n\n      this.mainIndex.refreshUiState();\n      var nextUiState = typeof uiState === 'function' ? uiState(this.mainIndex.getWidgetUiState({})) : uiState;\n\n      var setIndexHelperState = function setIndexHelperState(indexWidget) {\n        if (process.env.NODE_ENV === 'development') {\n          checkIndexUiState({\n            index: indexWidget,\n            indexUiState: nextUiState[indexWidget.getIndexId()]\n          });\n        }\n\n        indexWidget.getHelper().setState(indexWidget.getWidgetSearchParameters(indexWidget.getHelper().state, {\n          uiState: nextUiState[indexWidget.getIndexId()]\n        }));\n        indexWidget.getWidgets().filter(isIndexWidget).forEach(setIndexHelperState);\n      };\n\n      setIndexHelperState(this.mainIndex);\n      this.scheduleSearch();\n      this.onInternalStateChange();\n    }\n  }, {\n    key: \"getUiState\",\n    value: function getUiState() {\n      if (this.started) {\n        // We refresh the index UI state to make sure changes from `refine` are taken in account\n        this.mainIndex.refreshUiState();\n      }\n\n      return this.mainIndex.getWidgetUiState({});\n    }\n  }, {\n    key: \"createURL\",\n    value: function createURL() {\n      var nextState = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n      if (!this.started) {\n        throw new Error(withUsage('The `start` method needs to be called before `createURL`.'));\n      }\n\n      return this._createURL(nextState);\n    }\n  }, {\n    key: \"refresh\",\n    value: function refresh() {\n      if (!this.mainHelper) {\n        throw new Error(withUsage('The `start` method needs to be called before `refresh`.'));\n      }\n\n      this.mainHelper.clearCache().search();\n    }\n  }]);\n\n  return InstantSearch;\n}(EventEmitter);\n\nexport default InstantSearch;"]},"metadata":{},"sourceType":"module"}