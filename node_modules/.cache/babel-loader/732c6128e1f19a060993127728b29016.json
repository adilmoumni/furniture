{"ast":null,"code":"function _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nimport { checkRendering, createDocumentationLink, createDocumentationMessageGenerator, noop, warning } from '../../lib/utils';\nvar withUsage = createDocumentationMessageGenerator({\n  name: 'rating-menu',\n  connector: true\n});\nvar $$type = 'ais.ratingMenu';\nvar MAX_VALUES_PER_FACET_API_LIMIT = 1000;\nvar STEP = 1;\n\nvar createSendEvent = function createSendEvent(_ref) {\n  var instantSearchInstance = _ref.instantSearchInstance,\n      helper = _ref.helper,\n      getRefinedStar = _ref.getRefinedStar,\n      attribute = _ref.attribute;\n  return function () {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    if (args.length === 1) {\n      instantSearchInstance.sendEventToInsights(args[0]);\n      return;\n    }\n\n    var eventType = args[0],\n        facetValue = args[1],\n        _args$ = args[2],\n        eventName = _args$ === void 0 ? 'Filter Applied' : _args$;\n\n    if (eventType !== 'click') {\n      return;\n    }\n\n    var isRefined = getRefinedStar() === Number(facetValue);\n\n    if (!isRefined) {\n      instantSearchInstance.sendEventToInsights({\n        insightsMethod: 'clickedFilters',\n        widgetType: $$type,\n        eventType: eventType,\n        payload: {\n          eventName: eventName,\n          index: helper.getIndex(),\n          filters: [\"\".concat(attribute, \">=\").concat(facetValue)]\n        },\n        attribute: attribute\n      });\n    }\n  };\n};\n/**\n * **StarRating** connector provides the logic to build a custom widget that will let\n * the user refine search results based on ratings.\n *\n * The connector provides to the rendering: `refine()` to select a value and\n * `items` that are the values that can be selected. `refine` should be used\n * with `items.value`.\n */\n\n\nvar connectRatingMenu = function connectRatingMenu(renderFn) {\n  var unmountFn = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : noop;\n  checkRendering(renderFn, withUsage());\n  return function (widgetParams) {\n    var _ref2 = widgetParams || {},\n        attribute = _ref2.attribute,\n        _ref2$max = _ref2.max,\n        max = _ref2$max === void 0 ? 5 : _ref2$max;\n\n    var sendEvent;\n\n    if (!attribute) {\n      throw new Error(withUsage('The `attribute` option is required.'));\n    }\n\n    var _getRefinedStar = function getRefinedStar(state) {\n      var _values$;\n\n      var values = state.getNumericRefinements(attribute);\n\n      if (!((_values$ = values['>=']) !== null && _values$ !== void 0 && _values$.length)) {\n        return undefined;\n      }\n\n      return values['>='][0];\n    };\n\n    var getFacetsMaxDecimalPlaces = function getFacetsMaxDecimalPlaces(facetResults) {\n      var maxDecimalPlaces = 0;\n      facetResults.forEach(function (facetResult) {\n        var _facetResult$name$spl = facetResult.name.split('.'),\n            _facetResult$name$spl2 = _slicedToArray(_facetResult$name$spl, 2),\n            _facetResult$name$spl3 = _facetResult$name$spl2[1],\n            decimal = _facetResult$name$spl3 === void 0 ? '' : _facetResult$name$spl3;\n\n        maxDecimalPlaces = Math.max(maxDecimalPlaces, decimal.length);\n      });\n      return maxDecimalPlaces;\n    };\n\n    var getFacetValuesWarningMessage = function getFacetValuesWarningMessage(_ref3) {\n      var maxDecimalPlaces = _ref3.maxDecimalPlaces,\n          maxFacets = _ref3.maxFacets,\n          maxValuesPerFacet = _ref3.maxValuesPerFacet;\n      var maxDecimalPlacesInRange = Math.max(0, Math.floor(Math.log10(MAX_VALUES_PER_FACET_API_LIMIT / max)));\n      var maxFacetsInRange = Math.min(MAX_VALUES_PER_FACET_API_LIMIT, Math.pow(10, maxDecimalPlacesInRange) * max);\n      var solutions = [];\n\n      if (maxFacets > MAX_VALUES_PER_FACET_API_LIMIT) {\n        solutions.push(\"- Update your records to lower the precision of the values in the \\\"\".concat(attribute, \"\\\" attribute (for example: \").concat(5.123456789.toPrecision(maxDecimalPlaces + 1), \" to \").concat(5.123456789.toPrecision(maxDecimalPlacesInRange + 1), \")\"));\n      }\n\n      if (maxValuesPerFacet < maxFacetsInRange) {\n        solutions.push(\"- Increase the maximum number of facet values to \".concat(maxFacetsInRange, \" using the \\\"configure\\\" widget \").concat(createDocumentationLink({\n          name: 'configure'\n        }), \" and the \\\"maxValuesPerFacet\\\" parameter https://www.algolia.com/doc/api-reference/api-parameters/maxValuesPerFacet/\"));\n      }\n\n      return \"The \".concat(attribute, \" attribute can have \").concat(maxFacets, \" different values (0 to \").concat(max, \" with a maximum of \").concat(maxDecimalPlaces, \" decimals = \").concat(maxFacets, \") but you retrieved only \").concat(maxValuesPerFacet, \" facet values. Therefore the number of results that match the refinements can be incorrect.\\n    \").concat(solutions.length ? \"To resolve this problem you can:\\n\".concat(solutions.join('\\n')) : \"\");\n    };\n\n    function getRefinedState(state, facetValue) {\n      var isRefined = _getRefinedStar(state) === Number(facetValue);\n      var emptyState = state.resetPage().removeNumericRefinement(attribute);\n\n      if (!isRefined) {\n        return emptyState.addNumericRefinement(attribute, '<=', max).addNumericRefinement(attribute, '>=', Number(facetValue));\n      }\n\n      return emptyState;\n    }\n\n    var toggleRefinement = function toggleRefinement(helper, facetValue) {\n      sendEvent('click', facetValue);\n      helper.setState(getRefinedState(helper.state, facetValue)).search();\n    };\n\n    var connectorState = {\n      toggleRefinementFactory: function toggleRefinementFactory(helper) {\n        return toggleRefinement.bind(null, helper);\n      },\n      createURLFactory: function createURLFactory(_ref4) {\n        var state = _ref4.state,\n            createURL = _ref4.createURL;\n        return function (value) {\n          return createURL(getRefinedState(state, value));\n        };\n      }\n    };\n    return {\n      $$type: $$type,\n      init: function init(initOptions) {\n        var instantSearchInstance = initOptions.instantSearchInstance;\n        renderFn(_objectSpread(_objectSpread({}, this.getWidgetRenderState(initOptions)), {}, {\n          instantSearchInstance: instantSearchInstance\n        }), true);\n      },\n      render: function render(renderOptions) {\n        var instantSearchInstance = renderOptions.instantSearchInstance;\n        renderFn(_objectSpread(_objectSpread({}, this.getWidgetRenderState(renderOptions)), {}, {\n          instantSearchInstance: instantSearchInstance\n        }), false);\n      },\n      getRenderState: function getRenderState(renderState, renderOptions) {\n        return _objectSpread(_objectSpread({}, renderState), {}, {\n          ratingMenu: _objectSpread(_objectSpread({}, renderState.ratingMenu), {}, _defineProperty({}, attribute, this.getWidgetRenderState(renderOptions)))\n        });\n      },\n      getWidgetRenderState: function getWidgetRenderState(_ref5) {\n        var helper = _ref5.helper,\n            results = _ref5.results,\n            state = _ref5.state,\n            instantSearchInstance = _ref5.instantSearchInstance,\n            createURL = _ref5.createURL;\n        var facetValues = [];\n\n        if (!sendEvent) {\n          sendEvent = createSendEvent({\n            instantSearchInstance: instantSearchInstance,\n            helper: helper,\n            getRefinedStar: function getRefinedStar() {\n              return _getRefinedStar(helper.state);\n            },\n            attribute: attribute\n          });\n        }\n\n        if (results) {\n          var facetResults = results.getFacetValues(attribute, {});\n          var maxValuesPerFacet = facetResults.length;\n          var maxDecimalPlaces = getFacetsMaxDecimalPlaces(facetResults);\n          var maxFacets = Math.pow(10, maxDecimalPlaces) * max;\n          process.env.NODE_ENV === 'development' ? warning(maxFacets <= maxValuesPerFacet, getFacetValuesWarningMessage({\n            maxDecimalPlaces: maxDecimalPlaces,\n            maxFacets: maxFacets,\n            maxValuesPerFacet: maxValuesPerFacet\n          })) : void 0;\n\n          var refinedStar = _getRefinedStar(state);\n\n          var _loop = function _loop(star) {\n            var isRefined = refinedStar === star;\n            var count = facetResults.filter(function (f) {\n              return Number(f.name) >= star && Number(f.name) <= max;\n            }).map(function (f) {\n              return f.count;\n            }).reduce(function (sum, current) {\n              return sum + current;\n            }, 0);\n\n            if (refinedStar && !isRefined && count === 0) {\n              // skip count==0 when at least 1 refinement is enabled\n              // eslint-disable-next-line no-continue\n              return \"continue\";\n            }\n\n            var stars = _toConsumableArray(new Array(Math.floor(max / STEP))).map(function (_v, i) {\n              return i * STEP < star;\n            });\n\n            facetValues.push({\n              stars: stars,\n              name: String(star),\n              label: String(star),\n              value: String(star),\n              count: count,\n              isRefined: isRefined\n            });\n          };\n\n          for (var star = STEP; star < max; star += STEP) {\n            var _ret = _loop(star);\n\n            if (_ret === \"continue\") continue;\n          }\n        }\n\n        facetValues = facetValues.reverse();\n        return {\n          items: facetValues,\n          hasNoResults: results ? results.nbHits === 0 : true,\n          canRefine: facetValues.length > 0,\n          refine: connectorState.toggleRefinementFactory(helper),\n          sendEvent: sendEvent,\n          createURL: connectorState.createURLFactory({\n            state: state,\n            createURL: createURL\n          }),\n          widgetParams: widgetParams\n        };\n      },\n      dispose: function dispose(_ref6) {\n        var state = _ref6.state;\n        unmountFn();\n        return state.removeNumericRefinement(attribute);\n      },\n      getWidgetUiState: function getWidgetUiState(uiState, _ref7) {\n        var searchParameters = _ref7.searchParameters;\n\n        var value = _getRefinedStar(searchParameters);\n\n        if (typeof value !== 'number') {\n          return uiState;\n        }\n\n        return _objectSpread(_objectSpread({}, uiState), {}, {\n          ratingMenu: _objectSpread(_objectSpread({}, uiState.ratingMenu), {}, _defineProperty({}, attribute, value))\n        });\n      },\n      getWidgetSearchParameters: function getWidgetSearchParameters(searchParameters, _ref8) {\n        var uiState = _ref8.uiState;\n        var value = uiState.ratingMenu && uiState.ratingMenu[attribute];\n        var withoutRefinements = searchParameters.clearRefinements(attribute);\n        var withDisjunctiveFacet = withoutRefinements.addDisjunctiveFacet(attribute);\n\n        if (!value) {\n          return withDisjunctiveFacet.setQueryParameters({\n            numericRefinements: _objectSpread(_objectSpread({}, withDisjunctiveFacet.numericRefinements), {}, _defineProperty({}, attribute, {}))\n          });\n        }\n\n        return withDisjunctiveFacet.addNumericRefinement(attribute, '<=', max).addNumericRefinement(attribute, '>=', value);\n      }\n    };\n  };\n};\n\nexport default connectRatingMenu;","map":{"version":3,"sources":["/Users/adil/Documents/GitHub/furniture-front/node_modules/instantsearch.js/es/connectors/rating-menu/connectRatingMenu.js"],"names":["_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","TypeError","iter","Symbol","iterator","Object","Array","from","isArray","_arrayLikeToArray","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","obj","value","configurable","writable","_slicedToArray","_arrayWithHoles","_iterableToArrayLimit","_nonIterableRest","o","minLen","n","prototype","toString","call","slice","constructor","name","test","len","arr2","_arr","_n","_d","_e","undefined","_i","_s","next","done","err","checkRendering","createDocumentationLink","createDocumentationMessageGenerator","noop","warning","withUsage","connector","$$type","MAX_VALUES_PER_FACET_API_LIMIT","STEP","createSendEvent","_ref","instantSearchInstance","helper","getRefinedStar","attribute","_len","args","_key","sendEventToInsights","eventType","facetValue","_args$","eventName","isRefined","Number","insightsMethod","widgetType","payload","index","getIndex","filters","concat","connectRatingMenu","renderFn","unmountFn","widgetParams","_ref2","_ref2$max","max","sendEvent","Error","_getRefinedStar","state","_values$","values","getNumericRefinements","getFacetsMaxDecimalPlaces","facetResults","maxDecimalPlaces","facetResult","_facetResult$name$spl","split","_facetResult$name$spl2","_facetResult$name$spl3","decimal","Math","getFacetValuesWarningMessage","_ref3","maxFacets","maxValuesPerFacet","maxDecimalPlacesInRange","floor","log10","maxFacetsInRange","min","pow","solutions","toPrecision","join","getRefinedState","emptyState","resetPage","removeNumericRefinement","addNumericRefinement","toggleRefinement","setState","search","connectorState","toggleRefinementFactory","bind","createURLFactory","_ref4","createURL","init","initOptions","getWidgetRenderState","render","renderOptions","getRenderState","renderState","ratingMenu","_ref5","results","facetValues","getFacetValues","process","env","NODE_ENV","refinedStar","_loop","star","count","f","map","reduce","sum","current","stars","_v","String","label","_ret","reverse","items","hasNoResults","nbHits","canRefine","refine","dispose","_ref6","getWidgetUiState","uiState","_ref7","searchParameters","getWidgetSearchParameters","_ref8","withoutRefinements","clearRefinements","withDisjunctiveFacet","addDisjunctiveFacet","setQueryParameters","numericRefinements"],"mappings":"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","sourcesContent":["function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return; var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nimport { checkRendering, createDocumentationLink, createDocumentationMessageGenerator, noop, warning } from '../../lib/utils';\nvar withUsage = createDocumentationMessageGenerator({\n  name: 'rating-menu',\n  connector: true\n});\nvar $$type = 'ais.ratingMenu';\nvar MAX_VALUES_PER_FACET_API_LIMIT = 1000;\nvar STEP = 1;\n\nvar createSendEvent = function createSendEvent(_ref) {\n  var instantSearchInstance = _ref.instantSearchInstance,\n      helper = _ref.helper,\n      getRefinedStar = _ref.getRefinedStar,\n      attribute = _ref.attribute;\n  return function () {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    if (args.length === 1) {\n      instantSearchInstance.sendEventToInsights(args[0]);\n      return;\n    }\n\n    var eventType = args[0],\n        facetValue = args[1],\n        _args$ = args[2],\n        eventName = _args$ === void 0 ? 'Filter Applied' : _args$;\n\n    if (eventType !== 'click') {\n      return;\n    }\n\n    var isRefined = getRefinedStar() === Number(facetValue);\n\n    if (!isRefined) {\n      instantSearchInstance.sendEventToInsights({\n        insightsMethod: 'clickedFilters',\n        widgetType: $$type,\n        eventType: eventType,\n        payload: {\n          eventName: eventName,\n          index: helper.getIndex(),\n          filters: [\"\".concat(attribute, \">=\").concat(facetValue)]\n        },\n        attribute: attribute\n      });\n    }\n  };\n};\n\n/**\n * **StarRating** connector provides the logic to build a custom widget that will let\n * the user refine search results based on ratings.\n *\n * The connector provides to the rendering: `refine()` to select a value and\n * `items` that are the values that can be selected. `refine` should be used\n * with `items.value`.\n */\nvar connectRatingMenu = function connectRatingMenu(renderFn) {\n  var unmountFn = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : noop;\n  checkRendering(renderFn, withUsage());\n  return function (widgetParams) {\n    var _ref2 = widgetParams || {},\n        attribute = _ref2.attribute,\n        _ref2$max = _ref2.max,\n        max = _ref2$max === void 0 ? 5 : _ref2$max;\n\n    var sendEvent;\n\n    if (!attribute) {\n      throw new Error(withUsage('The `attribute` option is required.'));\n    }\n\n    var _getRefinedStar = function getRefinedStar(state) {\n      var _values$;\n\n      var values = state.getNumericRefinements(attribute);\n\n      if (!((_values$ = values['>=']) !== null && _values$ !== void 0 && _values$.length)) {\n        return undefined;\n      }\n\n      return values['>='][0];\n    };\n\n    var getFacetsMaxDecimalPlaces = function getFacetsMaxDecimalPlaces(facetResults) {\n      var maxDecimalPlaces = 0;\n      facetResults.forEach(function (facetResult) {\n        var _facetResult$name$spl = facetResult.name.split('.'),\n            _facetResult$name$spl2 = _slicedToArray(_facetResult$name$spl, 2),\n            _facetResult$name$spl3 = _facetResult$name$spl2[1],\n            decimal = _facetResult$name$spl3 === void 0 ? '' : _facetResult$name$spl3;\n\n        maxDecimalPlaces = Math.max(maxDecimalPlaces, decimal.length);\n      });\n      return maxDecimalPlaces;\n    };\n\n    var getFacetValuesWarningMessage = function getFacetValuesWarningMessage(_ref3) {\n      var maxDecimalPlaces = _ref3.maxDecimalPlaces,\n          maxFacets = _ref3.maxFacets,\n          maxValuesPerFacet = _ref3.maxValuesPerFacet;\n      var maxDecimalPlacesInRange = Math.max(0, Math.floor(Math.log10(MAX_VALUES_PER_FACET_API_LIMIT / max)));\n      var maxFacetsInRange = Math.min(MAX_VALUES_PER_FACET_API_LIMIT, Math.pow(10, maxDecimalPlacesInRange) * max);\n      var solutions = [];\n\n      if (maxFacets > MAX_VALUES_PER_FACET_API_LIMIT) {\n        solutions.push(\"- Update your records to lower the precision of the values in the \\\"\".concat(attribute, \"\\\" attribute (for example: \").concat(5.123456789.toPrecision(maxDecimalPlaces + 1), \" to \").concat(5.123456789.toPrecision(maxDecimalPlacesInRange + 1), \")\"));\n      }\n\n      if (maxValuesPerFacet < maxFacetsInRange) {\n        solutions.push(\"- Increase the maximum number of facet values to \".concat(maxFacetsInRange, \" using the \\\"configure\\\" widget \").concat(createDocumentationLink({\n          name: 'configure'\n        }), \" and the \\\"maxValuesPerFacet\\\" parameter https://www.algolia.com/doc/api-reference/api-parameters/maxValuesPerFacet/\"));\n      }\n\n      return \"The \".concat(attribute, \" attribute can have \").concat(maxFacets, \" different values (0 to \").concat(max, \" with a maximum of \").concat(maxDecimalPlaces, \" decimals = \").concat(maxFacets, \") but you retrieved only \").concat(maxValuesPerFacet, \" facet values. Therefore the number of results that match the refinements can be incorrect.\\n    \").concat(solutions.length ? \"To resolve this problem you can:\\n\".concat(solutions.join('\\n')) : \"\");\n    };\n\n    function getRefinedState(state, facetValue) {\n      var isRefined = _getRefinedStar(state) === Number(facetValue);\n      var emptyState = state.resetPage().removeNumericRefinement(attribute);\n\n      if (!isRefined) {\n        return emptyState.addNumericRefinement(attribute, '<=', max).addNumericRefinement(attribute, '>=', Number(facetValue));\n      }\n\n      return emptyState;\n    }\n\n    var toggleRefinement = function toggleRefinement(helper, facetValue) {\n      sendEvent('click', facetValue);\n      helper.setState(getRefinedState(helper.state, facetValue)).search();\n    };\n\n    var connectorState = {\n      toggleRefinementFactory: function toggleRefinementFactory(helper) {\n        return toggleRefinement.bind(null, helper);\n      },\n      createURLFactory: function createURLFactory(_ref4) {\n        var state = _ref4.state,\n            createURL = _ref4.createURL;\n        return function (value) {\n          return createURL(getRefinedState(state, value));\n        };\n      }\n    };\n    return {\n      $$type: $$type,\n      init: function init(initOptions) {\n        var instantSearchInstance = initOptions.instantSearchInstance;\n        renderFn(_objectSpread(_objectSpread({}, this.getWidgetRenderState(initOptions)), {}, {\n          instantSearchInstance: instantSearchInstance\n        }), true);\n      },\n      render: function render(renderOptions) {\n        var instantSearchInstance = renderOptions.instantSearchInstance;\n        renderFn(_objectSpread(_objectSpread({}, this.getWidgetRenderState(renderOptions)), {}, {\n          instantSearchInstance: instantSearchInstance\n        }), false);\n      },\n      getRenderState: function getRenderState(renderState, renderOptions) {\n        return _objectSpread(_objectSpread({}, renderState), {}, {\n          ratingMenu: _objectSpread(_objectSpread({}, renderState.ratingMenu), {}, _defineProperty({}, attribute, this.getWidgetRenderState(renderOptions)))\n        });\n      },\n      getWidgetRenderState: function getWidgetRenderState(_ref5) {\n        var helper = _ref5.helper,\n            results = _ref5.results,\n            state = _ref5.state,\n            instantSearchInstance = _ref5.instantSearchInstance,\n            createURL = _ref5.createURL;\n        var facetValues = [];\n\n        if (!sendEvent) {\n          sendEvent = createSendEvent({\n            instantSearchInstance: instantSearchInstance,\n            helper: helper,\n            getRefinedStar: function getRefinedStar() {\n              return _getRefinedStar(helper.state);\n            },\n            attribute: attribute\n          });\n        }\n\n        if (results) {\n          var facetResults = results.getFacetValues(attribute, {});\n          var maxValuesPerFacet = facetResults.length;\n          var maxDecimalPlaces = getFacetsMaxDecimalPlaces(facetResults);\n          var maxFacets = Math.pow(10, maxDecimalPlaces) * max;\n          process.env.NODE_ENV === 'development' ? warning(maxFacets <= maxValuesPerFacet, getFacetValuesWarningMessage({\n            maxDecimalPlaces: maxDecimalPlaces,\n            maxFacets: maxFacets,\n            maxValuesPerFacet: maxValuesPerFacet\n          })) : void 0;\n\n          var refinedStar = _getRefinedStar(state);\n\n          var _loop = function _loop(star) {\n            var isRefined = refinedStar === star;\n            var count = facetResults.filter(function (f) {\n              return Number(f.name) >= star && Number(f.name) <= max;\n            }).map(function (f) {\n              return f.count;\n            }).reduce(function (sum, current) {\n              return sum + current;\n            }, 0);\n\n            if (refinedStar && !isRefined && count === 0) {\n              // skip count==0 when at least 1 refinement is enabled\n              // eslint-disable-next-line no-continue\n              return \"continue\";\n            }\n\n            var stars = _toConsumableArray(new Array(Math.floor(max / STEP))).map(function (_v, i) {\n              return i * STEP < star;\n            });\n\n            facetValues.push({\n              stars: stars,\n              name: String(star),\n              label: String(star),\n              value: String(star),\n              count: count,\n              isRefined: isRefined\n            });\n          };\n\n          for (var star = STEP; star < max; star += STEP) {\n            var _ret = _loop(star);\n\n            if (_ret === \"continue\") continue;\n          }\n        }\n\n        facetValues = facetValues.reverse();\n        return {\n          items: facetValues,\n          hasNoResults: results ? results.nbHits === 0 : true,\n          canRefine: facetValues.length > 0,\n          refine: connectorState.toggleRefinementFactory(helper),\n          sendEvent: sendEvent,\n          createURL: connectorState.createURLFactory({\n            state: state,\n            createURL: createURL\n          }),\n          widgetParams: widgetParams\n        };\n      },\n      dispose: function dispose(_ref6) {\n        var state = _ref6.state;\n        unmountFn();\n        return state.removeNumericRefinement(attribute);\n      },\n      getWidgetUiState: function getWidgetUiState(uiState, _ref7) {\n        var searchParameters = _ref7.searchParameters;\n\n        var value = _getRefinedStar(searchParameters);\n\n        if (typeof value !== 'number') {\n          return uiState;\n        }\n\n        return _objectSpread(_objectSpread({}, uiState), {}, {\n          ratingMenu: _objectSpread(_objectSpread({}, uiState.ratingMenu), {}, _defineProperty({}, attribute, value))\n        });\n      },\n      getWidgetSearchParameters: function getWidgetSearchParameters(searchParameters, _ref8) {\n        var uiState = _ref8.uiState;\n        var value = uiState.ratingMenu && uiState.ratingMenu[attribute];\n        var withoutRefinements = searchParameters.clearRefinements(attribute);\n        var withDisjunctiveFacet = withoutRefinements.addDisjunctiveFacet(attribute);\n\n        if (!value) {\n          return withDisjunctiveFacet.setQueryParameters({\n            numericRefinements: _objectSpread(_objectSpread({}, withDisjunctiveFacet.numericRefinements), {}, _defineProperty({}, attribute, {}))\n          });\n        }\n\n        return withDisjunctiveFacet.addNumericRefinement(attribute, '<=', max).addNumericRefinement(attribute, '>=', value);\n      }\n    };\n  };\n};\n\nexport default connectRatingMenu;"]},"metadata":{},"sourceType":"module"}