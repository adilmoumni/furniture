{"ast":null,"code":"import \"vue\";\nimport \"../util/vue-compat/index-2.js\";\nimport { warn as t } from \"../util/warn.js\";\n\nvar e = function (e) {\n  var n;\n  void 0 === e && (e = {});\n  var i = e.connector;\n  return (n = {\n    inject: {\n      instantSearchInstance: {\n        from: \"$_ais_instantSearchInstance\",\n        default: function () {\n          var t = this.$options._componentTag;\n          throw new TypeError('It looks like you forgot to wrap your Algolia search component \"<' + t + '>\" inside of an \"<ais-instant-search>\" component.');\n        }\n      },\n      getParentIndex: {\n        from: \"$_ais_getParentIndex\",\n        default: function () {\n          var t = this;\n          return function () {\n            return t.instantSearchInstance.mainIndex;\n          };\n        }\n      }\n    },\n    data: function () {\n      return {\n        state: null\n      };\n    },\n    created: function () {\n      if (\"function\" == typeof i) {\n        if (this.factory = i(this.updateState, function () {}), this.widget = this.factory(this.widgetParams), this.getParentIndex().addWidgets([this.widget]), this.instantSearchInstance.__initialSearchResults && !this.instantSearchInstance.started) {\n          if (\"function\" != typeof this.instantSearchInstance.__forceRender) throw new Error(\"You are using server side rendering with <ais-instant-search> instead of <ais-instant-search-ssr>.\");\n\n          this.instantSearchInstance.__forceRender(this.widget, this.getParentIndex());\n        }\n      } else !0 !== i && t(\"You are using the InstantSearch widget mixin, but didn't provide a connector.\\nWhile this is technically possible, and will give you access to the Helper,\\nit's not the recommended way of making custom components.\\n\\nIf you want to disable this message, pass { connector: true } to the mixin.\\n\\nRead more on using connectors: https://alg.li/vue-custom\");\n    }\n  }).beforeDestroy = function () {\n    this.widget && this.getParentIndex().removeWidgets([this.widget]);\n  }, n.watch = {\n    widgetParams: {\n      handler: function (t) {\n        this.state = null, this.getParentIndex().removeWidgets([this.widget]), this.widget = this.factory(t), this.getParentIndex().addWidgets([this.widget]);\n      },\n      deep: !0\n    }\n  }, n.methods = {\n    updateState: function (t, e) {\n      void 0 === t && (t = {}), e || (this.state = t);\n    }\n  }, n;\n};\n\nexport { e as createWidgetMixin };","map":{"version":3,"sources":["../../../../src/mixins/widget.js"],"names":["createWidgetMixin","ref","inject","instantSearchInstance","from","default","const","tag","this","$options","_componentTag","TypeError","getParentIndex","mainIndex","data","state","created","connector","factory","updateState","widget","widgetParams","addWidgets","__initialSearchResults","started","__forceRender","Error","warn","removeWidgets","watch","handler","nextWidgetParams","deep","methods","isFirstRender"],"mappings":"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","sourcesContent":["import { isVue3 } from '../util/vue-compat';\nimport { warn } from '../util/warn';\n\nexport const createWidgetMixin = ({ connector } = {}) => ({\n  inject: {\n    instantSearchInstance: {\n      from: '$_ais_instantSearchInstance',\n      default() {\n        const tag = this.$options._componentTag;\n        throw new TypeError(\n          `It looks like you forgot to wrap your Algolia search component \"<${tag}>\" inside of an \"<ais-instant-search>\" component.`\n        );\n      },\n    },\n    getParentIndex: {\n      from: '$_ais_getParentIndex',\n      default() {\n        return () => this.instantSearchInstance.mainIndex;\n      },\n    },\n  },\n  data() {\n    return {\n      state: null,\n    };\n  },\n  created() {\n    if (typeof connector === 'function') {\n      this.factory = connector(this.updateState, () => {});\n      this.widget = this.factory(this.widgetParams);\n      this.getParentIndex().addWidgets([this.widget]);\n\n      if (\n        this.instantSearchInstance.__initialSearchResults &&\n        !this.instantSearchInstance.started\n      ) {\n        if (typeof this.instantSearchInstance.__forceRender !== 'function') {\n          throw new Error(\n            'You are using server side rendering with <ais-instant-search> instead of <ais-instant-search-ssr>.'\n          );\n        }\n        this.instantSearchInstance.__forceRender(\n          this.widget,\n          this.getParentIndex()\n        );\n      }\n    } else if (connector !== true) {\n      warn(\n        `You are using the InstantSearch widget mixin, but didn't provide a connector.\nWhile this is technically possible, and will give you access to the Helper,\nit's not the recommended way of making custom components.\n\nIf you want to disable this message, pass { connector: true } to the mixin.\n\nRead more on using connectors: https://alg.li/vue-custom`\n      );\n    }\n  },\n  [isVue3 ? 'beforeUnmount' : 'beforeDestroy']() {\n    if (this.widget) {\n      this.getParentIndex().removeWidgets([this.widget]);\n    }\n  },\n  watch: {\n    widgetParams: {\n      handler(nextWidgetParams) {\n        this.state = null;\n        this.getParentIndex().removeWidgets([this.widget]);\n        this.widget = this.factory(nextWidgetParams);\n        this.getParentIndex().addWidgets([this.widget]);\n      },\n      deep: true,\n    },\n  },\n  methods: {\n    updateState(state = {}, isFirstRender) {\n      if (!isFirstRender) {\n        // Avoid updating the state on first render\n        // otherwise there will be a flash of placeholder data\n        this.state = state;\n      }\n    },\n  },\n});\n"]},"metadata":{},"sourceType":"module"}