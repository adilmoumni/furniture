{"ast":null,"code":"function ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n\n  var target = _objectWithoutPropertiesLoose(source, excluded);\n\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nimport algoliasearchHelper from 'algoliasearch-helper';\nimport { checkIndexUiState, createDocumentationMessageGenerator, resolveSearchParameters, mergeSearchParameters, warning } from '../../lib/utils';\nvar withUsage = createDocumentationMessageGenerator({\n  name: 'index-widget'\n});\nexport function isIndexWidget(widget) {\n  return widget.$$type === 'ais.index';\n}\n/**\n * This is the same content as helper._change / setState, but allowing for extra\n * UiState to be synchronized.\n * see: https://github.com/algolia/algoliasearch-helper-js/blob/6b835ffd07742f2d6b314022cce6848f5cfecd4a/src/algoliasearch.helper.js#L1311-L1324\n */\n\nfunction privateHelperSetState(helper, _ref) {\n  var state = _ref.state,\n      isPageReset = _ref.isPageReset,\n      _uiState = _ref._uiState;\n\n  if (state !== helper.state) {\n    helper.state = state;\n    helper.emit('change', {\n      state: helper.state,\n      results: helper.lastResults,\n      isPageReset: isPageReset,\n      _uiState: _uiState\n    });\n  }\n}\n\nfunction getLocalWidgetsUiState(widgets, widgetStateOptions) {\n  var initialUiState = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  return widgets.reduce(function (uiState, widget) {\n    if (isIndexWidget(widget)) {\n      return uiState;\n    }\n\n    if (!widget.getWidgetUiState && !widget.getWidgetState) {\n      return uiState;\n    }\n\n    if (widget.getWidgetUiState) {\n      return widget.getWidgetUiState(uiState, widgetStateOptions);\n    }\n\n    return widget.getWidgetState(uiState, widgetStateOptions);\n  }, initialUiState);\n}\n\nfunction getLocalWidgetsSearchParameters(widgets, widgetSearchParametersOptions) {\n  var initialSearchParameters = widgetSearchParametersOptions.initialSearchParameters,\n      rest = _objectWithoutProperties(widgetSearchParametersOptions, [\"initialSearchParameters\"]);\n\n  return widgets.filter(function (widget) {\n    return !isIndexWidget(widget);\n  }).reduce(function (state, widget) {\n    if (!widget.getWidgetSearchParameters) {\n      return state;\n    }\n\n    return widget.getWidgetSearchParameters(state, rest);\n  }, initialSearchParameters);\n}\n\nfunction resetPageFromWidgets(widgets) {\n  var indexWidgets = widgets.filter(isIndexWidget);\n\n  if (indexWidgets.length === 0) {\n    return;\n  }\n\n  indexWidgets.forEach(function (widget) {\n    var widgetHelper = widget.getHelper();\n    privateHelperSetState(widgetHelper, {\n      state: widgetHelper.state.resetPage(),\n      isPageReset: true\n    });\n    resetPageFromWidgets(widget.getWidgets());\n  });\n}\n\nfunction resolveScopedResultsFromWidgets(widgets) {\n  var indexWidgets = widgets.filter(isIndexWidget);\n  return indexWidgets.reduce(function (scopedResults, current) {\n    return scopedResults.concat.apply(scopedResults, [{\n      indexId: current.getIndexId(),\n      results: current.getResults(),\n      helper: current.getHelper()\n    }].concat(_toConsumableArray(resolveScopedResultsFromWidgets(current.getWidgets()))));\n  }, []);\n}\n\nvar index = function index(widgetParams) {\n  if (widgetParams === undefined || widgetParams.indexName === undefined) {\n    throw new Error(withUsage('The `indexName` option is required.'));\n  }\n\n  var indexName = widgetParams.indexName,\n      _widgetParams$indexId = widgetParams.indexId,\n      indexId = _widgetParams$indexId === void 0 ? indexName : _widgetParams$indexId;\n  var localWidgets = [];\n  var localUiState = {};\n  var localInstantSearchInstance = null;\n  var localParent = null;\n  var helper = null;\n  var derivedHelper = null;\n  return {\n    $$type: 'ais.index',\n    $$widgetType: 'ais.index',\n    getIndexName: function getIndexName() {\n      return indexName;\n    },\n    getIndexId: function getIndexId() {\n      return indexId;\n    },\n    getHelper: function getHelper() {\n      return helper;\n    },\n    getResults: function getResults() {\n      return derivedHelper && derivedHelper.lastResults;\n    },\n    getScopedResults: function getScopedResults() {\n      var widgetParent = this.getParent(); // If the widget is the root, we consider itself as the only sibling.\n\n      var widgetSiblings = widgetParent ? widgetParent.getWidgets() : [this];\n      return resolveScopedResultsFromWidgets(widgetSiblings);\n    },\n    getParent: function getParent() {\n      return localParent;\n    },\n    createURL: function createURL(nextState) {\n      return localInstantSearchInstance._createURL(_defineProperty({}, indexId, getLocalWidgetsUiState(localWidgets, {\n        searchParameters: nextState,\n        helper: helper\n      })));\n    },\n    getWidgets: function getWidgets() {\n      return localWidgets;\n    },\n    addWidgets: function addWidgets(widgets) {\n      var _this = this;\n\n      if (!Array.isArray(widgets)) {\n        throw new Error(withUsage('The `addWidgets` method expects an array of widgets.'));\n      }\n\n      if (widgets.some(function (widget) {\n        return typeof widget.init !== 'function' && typeof widget.render !== 'function';\n      })) {\n        throw new Error(withUsage('The widget definition expects a `render` and/or an `init` method.'));\n      }\n\n      localWidgets = localWidgets.concat(widgets);\n\n      if (localInstantSearchInstance && Boolean(widgets.length)) {\n        privateHelperSetState(helper, {\n          state: getLocalWidgetsSearchParameters(localWidgets, {\n            uiState: localUiState,\n            initialSearchParameters: helper.state\n          }),\n          _uiState: localUiState\n        }); // We compute the render state before calling `init` in a separate loop\n        // to construct the whole render state object that is then passed to\n        // `init`.\n\n        widgets.forEach(function (widget) {\n          if (widget.getRenderState) {\n            var renderState = widget.getRenderState(localInstantSearchInstance.renderState[_this.getIndexId()] || {}, {\n              uiState: localInstantSearchInstance._initialUiState,\n              helper: _this.getHelper(),\n              parent: _this,\n              instantSearchInstance: localInstantSearchInstance,\n              state: helper.state,\n              renderState: localInstantSearchInstance.renderState,\n              templatesConfig: localInstantSearchInstance.templatesConfig,\n              createURL: _this.createURL,\n              scopedResults: [],\n              searchMetadata: {\n                isSearchStalled: localInstantSearchInstance._isSearchStalled\n              }\n            });\n            storeRenderState({\n              renderState: renderState,\n              instantSearchInstance: localInstantSearchInstance,\n              parent: _this\n            });\n          }\n        });\n        widgets.forEach(function (widget) {\n          if (widget.init) {\n            widget.init({\n              helper: helper,\n              parent: _this,\n              uiState: localInstantSearchInstance._initialUiState,\n              instantSearchInstance: localInstantSearchInstance,\n              state: helper.state,\n              renderState: localInstantSearchInstance.renderState,\n              templatesConfig: localInstantSearchInstance.templatesConfig,\n              createURL: _this.createURL,\n              scopedResults: [],\n              searchMetadata: {\n                isSearchStalled: localInstantSearchInstance._isSearchStalled\n              }\n            });\n          }\n        });\n        localInstantSearchInstance.scheduleSearch();\n      }\n\n      return this;\n    },\n    removeWidgets: function removeWidgets(widgets) {\n      var _this2 = this;\n\n      if (!Array.isArray(widgets)) {\n        throw new Error(withUsage('The `removeWidgets` method expects an array of widgets.'));\n      }\n\n      if (widgets.some(function (widget) {\n        return typeof widget.dispose !== 'function';\n      })) {\n        throw new Error(withUsage('The widget definition expects a `dispose` method.'));\n      }\n\n      localWidgets = localWidgets.filter(function (widget) {\n        return widgets.indexOf(widget) === -1;\n      });\n\n      if (localInstantSearchInstance && Boolean(widgets.length)) {\n        var nextState = widgets.reduce(function (state, widget) {\n          // the `dispose` method exists at this point we already assert it\n          var next = widget.dispose({\n            helper: helper,\n            state: state,\n            parent: _this2\n          });\n          return next || state;\n        }, helper.state);\n        localUiState = getLocalWidgetsUiState(localWidgets, {\n          searchParameters: nextState,\n          helper: helper\n        });\n        helper.setState(getLocalWidgetsSearchParameters(localWidgets, {\n          uiState: localUiState,\n          initialSearchParameters: nextState\n        }));\n\n        if (localWidgets.length) {\n          localInstantSearchInstance.scheduleSearch();\n        }\n      }\n\n      return this;\n    },\n    init: function init(_ref2) {\n      var _this3 = this;\n\n      var instantSearchInstance = _ref2.instantSearchInstance,\n          parent = _ref2.parent,\n          uiState = _ref2.uiState;\n\n      if (helper !== null) {\n        // helper is already initialized, therefore we do not need to set up\n        // any listeners\n        return;\n      }\n\n      localInstantSearchInstance = instantSearchInstance;\n      localParent = parent;\n      localUiState = uiState[indexId] || {}; // The `mainHelper` is already defined at this point. The instance is created\n      // inside InstantSearch at the `start` method, which occurs before the `init`\n      // step.\n\n      var mainHelper = instantSearchInstance.mainHelper;\n      var parameters = getLocalWidgetsSearchParameters(localWidgets, {\n        uiState: localUiState,\n        initialSearchParameters: new algoliasearchHelper.SearchParameters({\n          index: indexName\n        })\n      }); // This Helper is only used for state management we do not care about the\n      // `searchClient`. Only the \"main\" Helper created at the `InstantSearch`\n      // level is aware of the client.\n\n      helper = algoliasearchHelper({}, parameters.index, parameters); // We forward the call to `search` to the \"main\" instance of the Helper\n      // which is responsible for managing the queries (it's the only one that is\n      // aware of the `searchClient`).\n\n      helper.search = function () {\n        if (instantSearchInstance.onStateChange) {\n          instantSearchInstance.onStateChange({\n            uiState: instantSearchInstance.mainIndex.getWidgetUiState({}),\n            setUiState: instantSearchInstance.setUiState.bind(instantSearchInstance)\n          }); // We don't trigger a search when controlled because it becomes the\n          // responsibility of `setUiState`.\n\n          return mainHelper;\n        }\n\n        return mainHelper.search();\n      };\n\n      helper.searchWithoutTriggeringOnStateChange = function () {\n        return mainHelper.search();\n      }; // We use the same pattern for the `searchForFacetValues`.\n\n\n      helper.searchForFacetValues = function (facetName, facetValue, maxFacetHits, userState) {\n        var state = helper.state.setQueryParameters(userState);\n        return mainHelper.searchForFacetValues(facetName, facetValue, maxFacetHits, state);\n      };\n\n      derivedHelper = mainHelper.derive(function () {\n        return mergeSearchParameters.apply(void 0, _toConsumableArray(resolveSearchParameters(_this3)));\n      }); // Subscribe to the Helper state changes for the page before widgets\n      // are initialized. This behavior mimics the original one of the Helper.\n      // It makes sense to replicate it at the `init` step. We have another\n      // listener on `change` below, once `init` is done.\n\n      helper.on('change', function (_ref3) {\n        var isPageReset = _ref3.isPageReset;\n\n        if (isPageReset) {\n          resetPageFromWidgets(localWidgets);\n        }\n      });\n      derivedHelper.on('search', function () {\n        // The index does not manage the \"staleness\" of the search. This is the\n        // responsibility of the main instance. It does not make sense to manage\n        // it at the index level because it's either: all of them or none of them\n        // that are stalled. The queries are performed into a single network request.\n        instantSearchInstance.scheduleStalledRender();\n\n        if (process.env.NODE_ENV === 'development') {\n          checkIndexUiState({\n            index: _this3,\n            indexUiState: localUiState\n          });\n        }\n      });\n      derivedHelper.on('result', function (_ref4) {\n        var results = _ref4.results; // The index does not render the results it schedules a new render\n        // to let all the other indices emit their own results. It allows us to\n        // run the render process in one pass.\n\n        instantSearchInstance.scheduleRender(); // the derived helper is the one which actually searches, but the helper\n        // which is exposed e.g. via instance.helper, doesn't search, and thus\n        // does not have access to lastResults, which it used to in pre-federated\n        // search behavior.\n\n        helper.lastResults = results;\n      }); // We compute the render state before calling `init` in a separate loop\n      // to construct the whole render state object that is then passed to\n      // `init`.\n\n      localWidgets.forEach(function (widget) {\n        if (widget.getRenderState) {\n          var renderState = widget.getRenderState(instantSearchInstance.renderState[_this3.getIndexId()] || {}, {\n            uiState: uiState,\n            helper: helper,\n            parent: _this3,\n            instantSearchInstance: instantSearchInstance,\n            state: helper.state,\n            renderState: instantSearchInstance.renderState,\n            templatesConfig: instantSearchInstance.templatesConfig,\n            createURL: _this3.createURL,\n            scopedResults: [],\n            searchMetadata: {\n              isSearchStalled: instantSearchInstance._isSearchStalled\n            }\n          });\n          storeRenderState({\n            renderState: renderState,\n            instantSearchInstance: instantSearchInstance,\n            parent: _this3\n          });\n        }\n      });\n      localWidgets.forEach(function (widget) {\n        process.env.NODE_ENV === 'development' ? warning( // if it has NO getWidgetState or if it has getWidgetUiState, we don't warn\n        // aka we warn if there's _only_ getWidgetState\n        !widget.getWidgetState || Boolean(widget.getWidgetUiState), 'The `getWidgetState` method is renamed `getWidgetUiState` and will no longer exist under that name in InstantSearch.js 5.x. Please use `getWidgetUiState` instead.') : void 0;\n\n        if (widget.init) {\n          widget.init({\n            uiState: uiState,\n            helper: helper,\n            parent: _this3,\n            instantSearchInstance: instantSearchInstance,\n            state: helper.state,\n            renderState: instantSearchInstance.renderState,\n            templatesConfig: instantSearchInstance.templatesConfig,\n            createURL: _this3.createURL,\n            scopedResults: [],\n            searchMetadata: {\n              isSearchStalled: instantSearchInstance._isSearchStalled\n            }\n          });\n        }\n      }); // Subscribe to the Helper state changes for the `uiState` once widgets\n      // are initialized. Until the first render, state changes are part of the\n      // configuration step. This is mainly for backward compatibility with custom\n      // widgets. When the subscription happens before the `init` step, the (static)\n      // configuration of the widget is pushed in the URL. That's what we want to avoid.\n      // https://github.com/algolia/instantsearch.js/pull/994/commits/4a672ae3fd78809e213de0368549ef12e9dc9454\n\n      helper.on('change', function (event) {\n        var state = event.state;\n        var _uiState = event._uiState;\n        localUiState = getLocalWidgetsUiState(localWidgets, {\n          searchParameters: state,\n          helper: helper\n        }, _uiState || {}); // We don't trigger an internal change when controlled because it\n        // becomes the responsibility of `setUiState`.\n\n        if (!instantSearchInstance.onStateChange) {\n          instantSearchInstance.onInternalStateChange();\n        }\n      });\n    },\n    render: function render(_ref5) {\n      var _this4 = this;\n\n      var instantSearchInstance = _ref5.instantSearchInstance;\n\n      if (!this.getResults()) {\n        return;\n      }\n\n      localWidgets.forEach(function (widget) {\n        if (widget.getRenderState) {\n          var renderState = widget.getRenderState(instantSearchInstance.renderState[_this4.getIndexId()] || {}, {\n            helper: _this4.getHelper(),\n            parent: _this4,\n            instantSearchInstance: instantSearchInstance,\n            results: _this4.getResults(),\n            scopedResults: _this4.getScopedResults(),\n            state: _this4.getResults()._state,\n            renderState: instantSearchInstance.renderState,\n            templatesConfig: instantSearchInstance.templatesConfig,\n            createURL: _this4.createURL,\n            searchMetadata: {\n              isSearchStalled: instantSearchInstance._isSearchStalled\n            }\n          });\n          storeRenderState({\n            renderState: renderState,\n            instantSearchInstance: instantSearchInstance,\n            parent: _this4\n          });\n        }\n      });\n      localWidgets.forEach(function (widget) {\n        // At this point, all the variables used below are set. Both `helper`\n        // and `derivedHelper` have been created at the `init` step. The attribute\n        // `lastResults` might be `null` though. It's possible that a stalled render\n        // happens before the result e.g with a dynamically added index the request might\n        // be delayed. The render is triggered for the complete tree but some parts do\n        // not have results yet.\n        if (widget.render) {\n          widget.render({\n            helper: helper,\n            parent: _this4,\n            instantSearchInstance: instantSearchInstance,\n            results: _this4.getResults(),\n            scopedResults: _this4.getScopedResults(),\n            state: _this4.getResults()._state,\n            renderState: instantSearchInstance.renderState,\n            templatesConfig: instantSearchInstance.templatesConfig,\n            createURL: _this4.createURL,\n            searchMetadata: {\n              isSearchStalled: instantSearchInstance._isSearchStalled\n            }\n          });\n        }\n      });\n    },\n    dispose: function dispose() {\n      var _this5 = this;\n\n      localWidgets.forEach(function (widget) {\n        if (widget.dispose) {\n          // The dispose function is always called once the instance is started\n          // (it's an effect of `removeWidgets`). The index is initialized and\n          // the Helper is available. We don't care about the return value of\n          // `dispose` because the index is removed. We can't call `removeWidgets`\n          // because we want to keep the widgets on the instance, to allow idempotent\n          // operations on `add` & `remove`.\n          widget.dispose({\n            helper: helper,\n            state: helper.state,\n            parent: _this5\n          });\n        }\n      });\n      localInstantSearchInstance = null;\n      localParent = null;\n      helper.removeAllListeners();\n      helper = null;\n      derivedHelper.detach();\n      derivedHelper = null;\n    },\n    getWidgetUiState: function getWidgetUiState(uiState) {\n      return localWidgets.filter(isIndexWidget).reduce(function (previousUiState, innerIndex) {\n        return innerIndex.getWidgetUiState(previousUiState);\n      }, _objectSpread(_objectSpread({}, uiState), {}, _defineProperty({}, this.getIndexId(), localUiState)));\n    },\n    getWidgetState: function getWidgetState(uiState) {\n      process.env.NODE_ENV === 'development' ? warning(false, 'The `getWidgetState` method is renamed `getWidgetUiState` and will no longer exist under that name in InstantSearch.js 5.x. Please use `getWidgetUiState` instead.') : void 0;\n      return this.getWidgetUiState(uiState);\n    },\n    getWidgetSearchParameters: function getWidgetSearchParameters(searchParameters, _ref6) {\n      var uiState = _ref6.uiState;\n      return getLocalWidgetsSearchParameters(localWidgets, {\n        uiState: uiState,\n        initialSearchParameters: searchParameters\n      });\n    },\n    refreshUiState: function refreshUiState() {\n      localUiState = getLocalWidgetsUiState(localWidgets, {\n        searchParameters: this.getHelper().state,\n        helper: this.getHelper()\n      });\n    }\n  };\n};\n\nexport default index;\n\nfunction storeRenderState(_ref7) {\n  var renderState = _ref7.renderState,\n      instantSearchInstance = _ref7.instantSearchInstance,\n      parent = _ref7.parent;\n  var parentIndexName = parent ? parent.getIndexId() : instantSearchInstance.mainIndex.getIndexId();\n  instantSearchInstance.renderState = _objectSpread(_objectSpread({}, instantSearchInstance.renderState), {}, _defineProperty({}, parentIndexName, _objectSpread(_objectSpread({}, instantSearchInstance.renderState[parentIndexName]), renderState)));\n}","map":{"version":3,"sources":["/Users/adil/Documents/GitHub/furniture-front/node_modules/instantsearch.js/es/widgets/index/index.js"],"names":["ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","obj","value","configurable","writable","_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","TypeError","o","minLen","_arrayLikeToArray","n","prototype","toString","call","slice","constructor","name","Array","from","test","iter","Symbol","iterator","isArray","len","arr2","_objectWithoutProperties","excluded","_objectWithoutPropertiesLoose","sourceSymbolKeys","indexOf","propertyIsEnumerable","sourceKeys","algoliasearchHelper","checkIndexUiState","createDocumentationMessageGenerator","resolveSearchParameters","mergeSearchParameters","warning","withUsage","isIndexWidget","widget","$$type","privateHelperSetState","helper","_ref","state","isPageReset","_uiState","emit","results","lastResults","getLocalWidgetsUiState","widgets","widgetStateOptions","initialUiState","undefined","reduce","uiState","getWidgetUiState","getWidgetState","getLocalWidgetsSearchParameters","widgetSearchParametersOptions","initialSearchParameters","rest","getWidgetSearchParameters","resetPageFromWidgets","indexWidgets","widgetHelper","getHelper","resetPage","getWidgets","resolveScopedResultsFromWidgets","scopedResults","current","concat","indexId","getIndexId","getResults","index","widgetParams","indexName","Error","_widgetParams$indexId","localWidgets","localUiState","localInstantSearchInstance","localParent","derivedHelper","$$widgetType","getIndexName","getScopedResults","widgetParent","getParent","widgetSiblings","createURL","nextState","_createURL","searchParameters","addWidgets","_this","some","init","render","Boolean","getRenderState","renderState","_initialUiState","parent","instantSearchInstance","templatesConfig","searchMetadata","isSearchStalled","_isSearchStalled","storeRenderState","scheduleSearch","removeWidgets","_this2","dispose","next","setState","_ref2","_this3","mainHelper","parameters","SearchParameters","search","onStateChange","mainIndex","setUiState","bind","searchWithoutTriggeringOnStateChange","searchForFacetValues","facetName","facetValue","maxFacetHits","userState","setQueryParameters","derive","on","_ref3","scheduleStalledRender","process","env","NODE_ENV","indexUiState","_ref4","scheduleRender","event","onInternalStateChange","_ref5","_this4","_state","_this5","removeAllListeners","detach","previousUiState","innerIndex","_ref6","refreshUiState","_ref7","parentIndexName"],"mappings":"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","sourcesContent":["function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport algoliasearchHelper from 'algoliasearch-helper';\nimport { checkIndexUiState, createDocumentationMessageGenerator, resolveSearchParameters, mergeSearchParameters, warning } from '../../lib/utils';\nvar withUsage = createDocumentationMessageGenerator({\n  name: 'index-widget'\n});\nexport function isIndexWidget(widget) {\n  return widget.$$type === 'ais.index';\n}\n/**\n * This is the same content as helper._change / setState, but allowing for extra\n * UiState to be synchronized.\n * see: https://github.com/algolia/algoliasearch-helper-js/blob/6b835ffd07742f2d6b314022cce6848f5cfecd4a/src/algoliasearch.helper.js#L1311-L1324\n */\n\nfunction privateHelperSetState(helper, _ref) {\n  var state = _ref.state,\n      isPageReset = _ref.isPageReset,\n      _uiState = _ref._uiState;\n\n  if (state !== helper.state) {\n    helper.state = state;\n    helper.emit('change', {\n      state: helper.state,\n      results: helper.lastResults,\n      isPageReset: isPageReset,\n      _uiState: _uiState\n    });\n  }\n}\n\nfunction getLocalWidgetsUiState(widgets, widgetStateOptions) {\n  var initialUiState = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  return widgets.reduce(function (uiState, widget) {\n    if (isIndexWidget(widget)) {\n      return uiState;\n    }\n\n    if (!widget.getWidgetUiState && !widget.getWidgetState) {\n      return uiState;\n    }\n\n    if (widget.getWidgetUiState) {\n      return widget.getWidgetUiState(uiState, widgetStateOptions);\n    }\n\n    return widget.getWidgetState(uiState, widgetStateOptions);\n  }, initialUiState);\n}\n\nfunction getLocalWidgetsSearchParameters(widgets, widgetSearchParametersOptions) {\n  var initialSearchParameters = widgetSearchParametersOptions.initialSearchParameters,\n      rest = _objectWithoutProperties(widgetSearchParametersOptions, [\"initialSearchParameters\"]);\n\n  return widgets.filter(function (widget) {\n    return !isIndexWidget(widget);\n  }).reduce(function (state, widget) {\n    if (!widget.getWidgetSearchParameters) {\n      return state;\n    }\n\n    return widget.getWidgetSearchParameters(state, rest);\n  }, initialSearchParameters);\n}\n\nfunction resetPageFromWidgets(widgets) {\n  var indexWidgets = widgets.filter(isIndexWidget);\n\n  if (indexWidgets.length === 0) {\n    return;\n  }\n\n  indexWidgets.forEach(function (widget) {\n    var widgetHelper = widget.getHelper();\n    privateHelperSetState(widgetHelper, {\n      state: widgetHelper.state.resetPage(),\n      isPageReset: true\n    });\n    resetPageFromWidgets(widget.getWidgets());\n  });\n}\n\nfunction resolveScopedResultsFromWidgets(widgets) {\n  var indexWidgets = widgets.filter(isIndexWidget);\n  return indexWidgets.reduce(function (scopedResults, current) {\n    return scopedResults.concat.apply(scopedResults, [{\n      indexId: current.getIndexId(),\n      results: current.getResults(),\n      helper: current.getHelper()\n    }].concat(_toConsumableArray(resolveScopedResultsFromWidgets(current.getWidgets()))));\n  }, []);\n}\n\nvar index = function index(widgetParams) {\n  if (widgetParams === undefined || widgetParams.indexName === undefined) {\n    throw new Error(withUsage('The `indexName` option is required.'));\n  }\n\n  var indexName = widgetParams.indexName,\n      _widgetParams$indexId = widgetParams.indexId,\n      indexId = _widgetParams$indexId === void 0 ? indexName : _widgetParams$indexId;\n  var localWidgets = [];\n  var localUiState = {};\n  var localInstantSearchInstance = null;\n  var localParent = null;\n  var helper = null;\n  var derivedHelper = null;\n  return {\n    $$type: 'ais.index',\n    $$widgetType: 'ais.index',\n    getIndexName: function getIndexName() {\n      return indexName;\n    },\n    getIndexId: function getIndexId() {\n      return indexId;\n    },\n    getHelper: function getHelper() {\n      return helper;\n    },\n    getResults: function getResults() {\n      return derivedHelper && derivedHelper.lastResults;\n    },\n    getScopedResults: function getScopedResults() {\n      var widgetParent = this.getParent(); // If the widget is the root, we consider itself as the only sibling.\n\n      var widgetSiblings = widgetParent ? widgetParent.getWidgets() : [this];\n      return resolveScopedResultsFromWidgets(widgetSiblings);\n    },\n    getParent: function getParent() {\n      return localParent;\n    },\n    createURL: function createURL(nextState) {\n      return localInstantSearchInstance._createURL(_defineProperty({}, indexId, getLocalWidgetsUiState(localWidgets, {\n        searchParameters: nextState,\n        helper: helper\n      })));\n    },\n    getWidgets: function getWidgets() {\n      return localWidgets;\n    },\n    addWidgets: function addWidgets(widgets) {\n      var _this = this;\n\n      if (!Array.isArray(widgets)) {\n        throw new Error(withUsage('The `addWidgets` method expects an array of widgets.'));\n      }\n\n      if (widgets.some(function (widget) {\n        return typeof widget.init !== 'function' && typeof widget.render !== 'function';\n      })) {\n        throw new Error(withUsage('The widget definition expects a `render` and/or an `init` method.'));\n      }\n\n      localWidgets = localWidgets.concat(widgets);\n\n      if (localInstantSearchInstance && Boolean(widgets.length)) {\n        privateHelperSetState(helper, {\n          state: getLocalWidgetsSearchParameters(localWidgets, {\n            uiState: localUiState,\n            initialSearchParameters: helper.state\n          }),\n          _uiState: localUiState\n        }); // We compute the render state before calling `init` in a separate loop\n        // to construct the whole render state object that is then passed to\n        // `init`.\n\n        widgets.forEach(function (widget) {\n          if (widget.getRenderState) {\n            var renderState = widget.getRenderState(localInstantSearchInstance.renderState[_this.getIndexId()] || {}, {\n              uiState: localInstantSearchInstance._initialUiState,\n              helper: _this.getHelper(),\n              parent: _this,\n              instantSearchInstance: localInstantSearchInstance,\n              state: helper.state,\n              renderState: localInstantSearchInstance.renderState,\n              templatesConfig: localInstantSearchInstance.templatesConfig,\n              createURL: _this.createURL,\n              scopedResults: [],\n              searchMetadata: {\n                isSearchStalled: localInstantSearchInstance._isSearchStalled\n              }\n            });\n            storeRenderState({\n              renderState: renderState,\n              instantSearchInstance: localInstantSearchInstance,\n              parent: _this\n            });\n          }\n        });\n        widgets.forEach(function (widget) {\n          if (widget.init) {\n            widget.init({\n              helper: helper,\n              parent: _this,\n              uiState: localInstantSearchInstance._initialUiState,\n              instantSearchInstance: localInstantSearchInstance,\n              state: helper.state,\n              renderState: localInstantSearchInstance.renderState,\n              templatesConfig: localInstantSearchInstance.templatesConfig,\n              createURL: _this.createURL,\n              scopedResults: [],\n              searchMetadata: {\n                isSearchStalled: localInstantSearchInstance._isSearchStalled\n              }\n            });\n          }\n        });\n        localInstantSearchInstance.scheduleSearch();\n      }\n\n      return this;\n    },\n    removeWidgets: function removeWidgets(widgets) {\n      var _this2 = this;\n\n      if (!Array.isArray(widgets)) {\n        throw new Error(withUsage('The `removeWidgets` method expects an array of widgets.'));\n      }\n\n      if (widgets.some(function (widget) {\n        return typeof widget.dispose !== 'function';\n      })) {\n        throw new Error(withUsage('The widget definition expects a `dispose` method.'));\n      }\n\n      localWidgets = localWidgets.filter(function (widget) {\n        return widgets.indexOf(widget) === -1;\n      });\n\n      if (localInstantSearchInstance && Boolean(widgets.length)) {\n        var nextState = widgets.reduce(function (state, widget) {\n          // the `dispose` method exists at this point we already assert it\n          var next = widget.dispose({\n            helper: helper,\n            state: state,\n            parent: _this2\n          });\n          return next || state;\n        }, helper.state);\n        localUiState = getLocalWidgetsUiState(localWidgets, {\n          searchParameters: nextState,\n          helper: helper\n        });\n        helper.setState(getLocalWidgetsSearchParameters(localWidgets, {\n          uiState: localUiState,\n          initialSearchParameters: nextState\n        }));\n\n        if (localWidgets.length) {\n          localInstantSearchInstance.scheduleSearch();\n        }\n      }\n\n      return this;\n    },\n    init: function init(_ref2) {\n      var _this3 = this;\n\n      var instantSearchInstance = _ref2.instantSearchInstance,\n          parent = _ref2.parent,\n          uiState = _ref2.uiState;\n\n      if (helper !== null) {\n        // helper is already initialized, therefore we do not need to set up\n        // any listeners\n        return;\n      }\n\n      localInstantSearchInstance = instantSearchInstance;\n      localParent = parent;\n      localUiState = uiState[indexId] || {}; // The `mainHelper` is already defined at this point. The instance is created\n      // inside InstantSearch at the `start` method, which occurs before the `init`\n      // step.\n\n      var mainHelper = instantSearchInstance.mainHelper;\n      var parameters = getLocalWidgetsSearchParameters(localWidgets, {\n        uiState: localUiState,\n        initialSearchParameters: new algoliasearchHelper.SearchParameters({\n          index: indexName\n        })\n      }); // This Helper is only used for state management we do not care about the\n      // `searchClient`. Only the \"main\" Helper created at the `InstantSearch`\n      // level is aware of the client.\n\n      helper = algoliasearchHelper({}, parameters.index, parameters); // We forward the call to `search` to the \"main\" instance of the Helper\n      // which is responsible for managing the queries (it's the only one that is\n      // aware of the `searchClient`).\n\n      helper.search = function () {\n        if (instantSearchInstance.onStateChange) {\n          instantSearchInstance.onStateChange({\n            uiState: instantSearchInstance.mainIndex.getWidgetUiState({}),\n            setUiState: instantSearchInstance.setUiState.bind(instantSearchInstance)\n          }); // We don't trigger a search when controlled because it becomes the\n          // responsibility of `setUiState`.\n\n          return mainHelper;\n        }\n\n        return mainHelper.search();\n      };\n\n      helper.searchWithoutTriggeringOnStateChange = function () {\n        return mainHelper.search();\n      }; // We use the same pattern for the `searchForFacetValues`.\n\n\n      helper.searchForFacetValues = function (facetName, facetValue, maxFacetHits, userState) {\n        var state = helper.state.setQueryParameters(userState);\n        return mainHelper.searchForFacetValues(facetName, facetValue, maxFacetHits, state);\n      };\n\n      derivedHelper = mainHelper.derive(function () {\n        return mergeSearchParameters.apply(void 0, _toConsumableArray(resolveSearchParameters(_this3)));\n      }); // Subscribe to the Helper state changes for the page before widgets\n      // are initialized. This behavior mimics the original one of the Helper.\n      // It makes sense to replicate it at the `init` step. We have another\n      // listener on `change` below, once `init` is done.\n\n      helper.on('change', function (_ref3) {\n        var isPageReset = _ref3.isPageReset;\n\n        if (isPageReset) {\n          resetPageFromWidgets(localWidgets);\n        }\n      });\n      derivedHelper.on('search', function () {\n        // The index does not manage the \"staleness\" of the search. This is the\n        // responsibility of the main instance. It does not make sense to manage\n        // it at the index level because it's either: all of them or none of them\n        // that are stalled. The queries are performed into a single network request.\n        instantSearchInstance.scheduleStalledRender();\n\n        if (process.env.NODE_ENV === 'development') {\n          checkIndexUiState({\n            index: _this3,\n            indexUiState: localUiState\n          });\n        }\n      });\n      derivedHelper.on('result', function (_ref4) {\n        var results = _ref4.results;\n        // The index does not render the results it schedules a new render\n        // to let all the other indices emit their own results. It allows us to\n        // run the render process in one pass.\n        instantSearchInstance.scheduleRender(); // the derived helper is the one which actually searches, but the helper\n        // which is exposed e.g. via instance.helper, doesn't search, and thus\n        // does not have access to lastResults, which it used to in pre-federated\n        // search behavior.\n\n        helper.lastResults = results;\n      }); // We compute the render state before calling `init` in a separate loop\n      // to construct the whole render state object that is then passed to\n      // `init`.\n\n      localWidgets.forEach(function (widget) {\n        if (widget.getRenderState) {\n          var renderState = widget.getRenderState(instantSearchInstance.renderState[_this3.getIndexId()] || {}, {\n            uiState: uiState,\n            helper: helper,\n            parent: _this3,\n            instantSearchInstance: instantSearchInstance,\n            state: helper.state,\n            renderState: instantSearchInstance.renderState,\n            templatesConfig: instantSearchInstance.templatesConfig,\n            createURL: _this3.createURL,\n            scopedResults: [],\n            searchMetadata: {\n              isSearchStalled: instantSearchInstance._isSearchStalled\n            }\n          });\n          storeRenderState({\n            renderState: renderState,\n            instantSearchInstance: instantSearchInstance,\n            parent: _this3\n          });\n        }\n      });\n      localWidgets.forEach(function (widget) {\n        process.env.NODE_ENV === 'development' ? warning( // if it has NO getWidgetState or if it has getWidgetUiState, we don't warn\n        // aka we warn if there's _only_ getWidgetState\n        !widget.getWidgetState || Boolean(widget.getWidgetUiState), 'The `getWidgetState` method is renamed `getWidgetUiState` and will no longer exist under that name in InstantSearch.js 5.x. Please use `getWidgetUiState` instead.') : void 0;\n\n        if (widget.init) {\n          widget.init({\n            uiState: uiState,\n            helper: helper,\n            parent: _this3,\n            instantSearchInstance: instantSearchInstance,\n            state: helper.state,\n            renderState: instantSearchInstance.renderState,\n            templatesConfig: instantSearchInstance.templatesConfig,\n            createURL: _this3.createURL,\n            scopedResults: [],\n            searchMetadata: {\n              isSearchStalled: instantSearchInstance._isSearchStalled\n            }\n          });\n        }\n      }); // Subscribe to the Helper state changes for the `uiState` once widgets\n      // are initialized. Until the first render, state changes are part of the\n      // configuration step. This is mainly for backward compatibility with custom\n      // widgets. When the subscription happens before the `init` step, the (static)\n      // configuration of the widget is pushed in the URL. That's what we want to avoid.\n      // https://github.com/algolia/instantsearch.js/pull/994/commits/4a672ae3fd78809e213de0368549ef12e9dc9454\n\n      helper.on('change', function (event) {\n        var state = event.state;\n        var _uiState = event._uiState;\n        localUiState = getLocalWidgetsUiState(localWidgets, {\n          searchParameters: state,\n          helper: helper\n        }, _uiState || {}); // We don't trigger an internal change when controlled because it\n        // becomes the responsibility of `setUiState`.\n\n        if (!instantSearchInstance.onStateChange) {\n          instantSearchInstance.onInternalStateChange();\n        }\n      });\n    },\n    render: function render(_ref5) {\n      var _this4 = this;\n\n      var instantSearchInstance = _ref5.instantSearchInstance;\n\n      if (!this.getResults()) {\n        return;\n      }\n\n      localWidgets.forEach(function (widget) {\n        if (widget.getRenderState) {\n          var renderState = widget.getRenderState(instantSearchInstance.renderState[_this4.getIndexId()] || {}, {\n            helper: _this4.getHelper(),\n            parent: _this4,\n            instantSearchInstance: instantSearchInstance,\n            results: _this4.getResults(),\n            scopedResults: _this4.getScopedResults(),\n            state: _this4.getResults()._state,\n            renderState: instantSearchInstance.renderState,\n            templatesConfig: instantSearchInstance.templatesConfig,\n            createURL: _this4.createURL,\n            searchMetadata: {\n              isSearchStalled: instantSearchInstance._isSearchStalled\n            }\n          });\n          storeRenderState({\n            renderState: renderState,\n            instantSearchInstance: instantSearchInstance,\n            parent: _this4\n          });\n        }\n      });\n      localWidgets.forEach(function (widget) {\n        // At this point, all the variables used below are set. Both `helper`\n        // and `derivedHelper` have been created at the `init` step. The attribute\n        // `lastResults` might be `null` though. It's possible that a stalled render\n        // happens before the result e.g with a dynamically added index the request might\n        // be delayed. The render is triggered for the complete tree but some parts do\n        // not have results yet.\n        if (widget.render) {\n          widget.render({\n            helper: helper,\n            parent: _this4,\n            instantSearchInstance: instantSearchInstance,\n            results: _this4.getResults(),\n            scopedResults: _this4.getScopedResults(),\n            state: _this4.getResults()._state,\n            renderState: instantSearchInstance.renderState,\n            templatesConfig: instantSearchInstance.templatesConfig,\n            createURL: _this4.createURL,\n            searchMetadata: {\n              isSearchStalled: instantSearchInstance._isSearchStalled\n            }\n          });\n        }\n      });\n    },\n    dispose: function dispose() {\n      var _this5 = this;\n\n      localWidgets.forEach(function (widget) {\n        if (widget.dispose) {\n          // The dispose function is always called once the instance is started\n          // (it's an effect of `removeWidgets`). The index is initialized and\n          // the Helper is available. We don't care about the return value of\n          // `dispose` because the index is removed. We can't call `removeWidgets`\n          // because we want to keep the widgets on the instance, to allow idempotent\n          // operations on `add` & `remove`.\n          widget.dispose({\n            helper: helper,\n            state: helper.state,\n            parent: _this5\n          });\n        }\n      });\n      localInstantSearchInstance = null;\n      localParent = null;\n      helper.removeAllListeners();\n      helper = null;\n      derivedHelper.detach();\n      derivedHelper = null;\n    },\n    getWidgetUiState: function getWidgetUiState(uiState) {\n      return localWidgets.filter(isIndexWidget).reduce(function (previousUiState, innerIndex) {\n        return innerIndex.getWidgetUiState(previousUiState);\n      }, _objectSpread(_objectSpread({}, uiState), {}, _defineProperty({}, this.getIndexId(), localUiState)));\n    },\n    getWidgetState: function getWidgetState(uiState) {\n      process.env.NODE_ENV === 'development' ? warning(false, 'The `getWidgetState` method is renamed `getWidgetUiState` and will no longer exist under that name in InstantSearch.js 5.x. Please use `getWidgetUiState` instead.') : void 0;\n      return this.getWidgetUiState(uiState);\n    },\n    getWidgetSearchParameters: function getWidgetSearchParameters(searchParameters, _ref6) {\n      var uiState = _ref6.uiState;\n      return getLocalWidgetsSearchParameters(localWidgets, {\n        uiState: uiState,\n        initialSearchParameters: searchParameters\n      });\n    },\n    refreshUiState: function refreshUiState() {\n      localUiState = getLocalWidgetsUiState(localWidgets, {\n        searchParameters: this.getHelper().state,\n        helper: this.getHelper()\n      });\n    }\n  };\n};\n\nexport default index;\n\nfunction storeRenderState(_ref7) {\n  var renderState = _ref7.renderState,\n      instantSearchInstance = _ref7.instantSearchInstance,\n      parent = _ref7.parent;\n  var parentIndexName = parent ? parent.getIndexId() : instantSearchInstance.mainIndex.getIndexId();\n  instantSearchInstance.renderState = _objectSpread(_objectSpread({}, instantSearchInstance.renderState), {}, _defineProperty({}, parentIndexName, _objectSpread(_objectSpread({}, instantSearchInstance.renderState[parentIndexName]), renderState)));\n}"]},"metadata":{},"sourceType":"module"}